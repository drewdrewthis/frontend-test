"use strict";function getData(){return $.ajax({dataType:"json",url:"https://www.deskbookers.com/nl-nl/sajax.json?q=Amsterdam&type=-&people=any&favorite=0&pid=&sw=52.293753%2C4.634942&ne=52.455562%2C5.162286&ids=17201%2C19640%2C13692%2C13691%2C12136%2C17938%2C15292%2C14886%2C14885%2C14884%2C14883%2C15730%2C15353%2C15351%2C15330%2C15080%2C17290%2C15454%2C15451%2C15379"})}function createCarousel(t,e){function n(){var t='\n\t\t\t<div class="control-wrapper left">\n\t\t\t\t<div class="control left-control">\n\t\t\t\t\t<i class="fa fa-chevron-left" aria-hidden="true"></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="control-wrapper right">\n\t\t\t\t<div class="control right-control">\n\t\t\t\t\t<i class="fa fa-chevron-right" aria-hidden="true"></i>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t';o.append(t),o.find(".right-control").on("click",function(){o.nextImage()}),o.find(".left-control").on("click",function(){o.prevImage()})}var o=$(t);return o.current=0,o.images=e,o.goToImage=function(t){console.log("Go to image",t),$(".carousel-item").fadeOut(),$('.carousel-item[data-id="'+t+'"]').fadeIn(),0===o.images.length?o.find(".control").hide():0===o.current?(o.find(".left-control").hide(),o.find(".right-control").show()):o.current===o.images.length-1?(o.find(".left-control").show(),o.find(".right-control").hide()):(console.log("show both"),o.find(".control").show())},o.updateImages=function(t){o.images=t,o.find("ul").html(""),t.forEach(function(t,e){"string"==typeof t&&o.find("ul").append('\n\t\t\t\t\t\t<li id="image-'+e+'" \n\t\t\t\t\t\t\tdata-id="'+e+'" \n\t\t\t\t\t\t\tclass="carousel-item" \n\t\t\t\t\t\t\tstyle="background-image:url(\''+t+"')\"></li>\n\t\t\t\t\t")}),o.goToImage(0)},o.nextImage=function(){console.log("Go to image"),o.images[o.current+1]&&o.goToImage(o.current++)},o.prevImage=function(){o.images[o.current-1]&&o.goToImage(o.current--)},n(),o.append("<ul></ul>"),o.updateImages(e),o}function predictSearch(t){var e=app.model.rows;e.sort(function(t,e){return t.name.localeCompare(e.name)});var n=e.filter(function(e){return e.name.toLowerCase().includes(t.toLowerCase())});fillPredictor(".predictive-results",n.slice(0,5))}function fillPredictor(t,e){var n=$(t);n.html(""),console.log(e);var o=!0,i=!1,a=void 0;try{for(var r,c=e[Symbol.iterator]();!(o=(r=c.next()).done);o=!0){var l=r.value;n.append('\n\t\t\t<li data-id="'+l.location_id+'" \n\t\t\t\tclass="predictive-item"\n\t\t\t\tdata-name="'+l.name+'">'+l.name+"</li>")}}catch(s){i=!0,a=s}finally{try{!o&&c["return"]&&c["return"]()}finally{if(i)throw a}}}function processSearch(t){console.log(t),$('#location-search-form input[type="text"]').val("")}function updateResults(t){t.map(function(t,e){var n=t.name,o=t.location_name,i=t.rating||"-",a=t.day_price?"$"+t.day_price+"/day":"",r=t.image_urls[0];$(".results-list").append('<li \n        \tid="location-'+e+'" \n        \tclass="result-item" \n        \tstyle="background-image:url(\''+r+'\')">\n\t\t\t\t<ul class="location-info">\n\t\t\t\t\t<li>'+n+"</li>\n\t\t\t\t\t<li>"+o+"</li>\n\t\t\t\t\t<li>Score: "+i+"</li>\n\t\t\t\t\t<li>"+a+"</li>\n\t\t\t\t</ul>\n\t\t\t</li>")})}function setEventHandlers(){$("#location-search-form").submit(function(t){var e=$('input[type="text"]').val();t.preventDefault(),console.log(e),processSearch(e),$('input[type="text"]').val("")}),$('#location-search-form input[type="text"]').focus(function(){$('#location-search-form input[type="text"]').keydown(function(t){var e=$('#location-search-form input[type="text"]').val();console.log(e),predictSearch(e),$(".predictive-box").show()})}),$('#location-search-form input[type="text"]').focus(function(){$('#location-search-form input[type="text"]').keydown(function(t){var e=$('#location-search-form input[type="text"]').val();console.log(e),predictSearch(e),$(".predictive-box").show()})}),$('#location-search-form input[type="text"]').focusout(function(){$(".predictive-box").hide()}),$(".predictive-item").on("click",function(){$(".predictive-results").html(""),processSearch($(this).data("name")),$(".predictive-box").hide()})}var max_results=5,app={init:function(){$.when(getData()).then(function(t){console.log("Retrieved data".data),app.model=t;var e=t.rows.slice(0,max_results),n=t.rows.reduce(function(t,e){return t.concat(e.image_urls)},[]);console.log(n[0].length),app.main_carousel=createCarousel("carousel",n),updateResults(e)}),setEventHandlers()}};$(document).ready(function(){app.init()});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJnZXREYXRhIiwiJCIsImFqYXgiLCJkYXRhVHlwZSIsInVybCIsImNyZWF0ZUNhcm91c2VsIiwiZWxlbWVudCIsImltYWdlX2FyciIsImNyZWF0ZUNvbnRyb2xzIiwidGVtcGxhdGUiLCIkY2Fyb3VzZWwiLCJhcHBlbmQiLCJmaW5kIiwib24iLCJuZXh0SW1hZ2UiLCJwcmV2SW1hZ2UiLCJjdXJyZW50IiwiaW1hZ2VzIiwiZ29Ub0ltYWdlIiwiaW5kZXgiLCJjb25zb2xlIiwibG9nIiwiZmFkZU91dCIsImZhZGVJbiIsImxlbmd0aCIsImhpZGUiLCJzaG93IiwidXBkYXRlSW1hZ2VzIiwiaHRtbCIsImZvckVhY2giLCJwcmVkaWN0U2VhcmNoIiwic3RyIiwibG9jYXRpb25zIiwiYXBwIiwibW9kZWwiLCJyb3dzIiwic29ydCIsImEiLCJiIiwibmFtZSIsImxvY2FsZUNvbXBhcmUiLCJyZXN1bHRzIiwiZmlsdGVyIiwicGxhY2UiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiZmlsbFByZWRpY3RvciIsInNsaWNlIiwiYXJyIiwiJHByZWRpY3RvciIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwidW5kZWZpbmVkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwibG9jYXRpb24iLCJ2YWx1ZSIsImxvY2F0aW9uX2lkIiwiZXJyIiwicHJvY2Vzc1NlYXJjaCIsInZhbCIsInVwZGF0ZVJlc3VsdHMiLCJtYXAiLCJ3b3JrcGxhY2UiLCJsb2NhdGlvbl9uYW1lIiwicmV2aWV3X3Njb3JlIiwicmF0aW5nIiwicHJpY2UiLCJkYXlfcHJpY2UiLCJpbWFnZV91cmwiLCJpbWFnZV91cmxzIiwic2V0RXZlbnRIYW5kbGVycyIsInN1Ym1pdCIsImUiLCJzZWFyY2hfaW5xdWlyeSIsInByZXZlbnREZWZhdWx0IiwiZm9jdXMiLCJrZXlkb3duIiwiZm9jdXNvdXQiLCJ0aGlzIiwiZGF0YSIsIm1heF9yZXN1bHRzIiwiaW5pdCIsIndoZW4iLCJ0aGVuIiwibWFpbl9pbWFnZXMiLCJyZWR1Y2UiLCJhbGxfaW1hZ2VzIiwiY29uY2F0IiwibWFpbl9jYXJvdXNlbCIsImRvY3VtZW50IiwicmVhZHkiXSwibWFwcGluZ3MiOiJBQUFBLFlBSUEsU0FBU0EsV0FDTCxNQUFPQyxHQUFFQyxNQUNMQyxTQUFVLE9BQ1ZDLElBQUssaVRBSWIsUUFBU0MsZ0JBQWVDLEVBQVNDLEdBTTdCLFFBQVNDLEtBQ0wsR0FBSUMsR0FBQUEscVhBYUpDLEdBQVVDLE9BQU9GLEdBRWpCQyxFQUFVRSxLQUFLLGtCQUFrQkMsR0FBRyxRQUFTLFdBQ3pDSCxFQUFVSSxjQUdkSixFQUFVRSxLQUFLLGlCQUFpQkMsR0FBRyxRQUFTLFdBQ3hDSCxFQUFVSyxjQXpCbEIsR0FBSUwsR0FBWVQsRUFBRUssRUFtRmxCLE9BbEZBSSxHQUFVTSxRQUFVLEVBQ3BCTixFQUFVTyxPQUFTVixFQTJCbkJHLEVBQVVRLFVBQVksU0FBU0MsR0FDM0JDLFFBQVFDLElBQUksY0FBZUYsR0FDM0JsQixFQUFFLGtCQUFrQnFCLFVBQ3BCckIsRUFBQUEsMkJBQTZCa0IsRUFBN0IsTUFBd0NJLFNBRVIsSUFBNUJiLEVBQVVPLE9BQU9PLE9BQ2pCZCxFQUFVRSxLQUFLLFlBQVlhLE9BQ0UsSUFBdEJmLEVBQVVNLFNBQ2pCTixFQUFVRSxLQUFLLGlCQUFpQmEsT0FDaENmLEVBQVVFLEtBQUssa0JBQWtCYyxRQUMxQmhCLEVBQVVNLFVBQVlOLEVBQVVPLE9BQU9PLE9BQVMsR0FDdkRkLEVBQVVFLEtBQUssaUJBQWlCYyxPQUNoQ2hCLEVBQVVFLEtBQUssa0JBQWtCYSxTQUVqQ0wsUUFBUUMsSUFBSSxhQUNaWCxFQUFVRSxLQUFLLFlBQVljLFNBSW5DaEIsRUFBVWlCLGFBQWUsU0FBU1YsR0FDOUJQLEVBQVVPLE9BQVNBLEVBQ25CUCxFQUFVRSxLQUFLLE1BQU1nQixLQUFLLElB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QUUsbUJBQW1CeUIsV0FJN0J6QixFQUFFLDRDQUE0Q2tGLFNBQVMsV0FDbkRsRixFQUFFLG1CQUFtQndCLFNBR3pCeEIsRUFBRSxvQkFBb0JZLEdBQUcsUUFBUyxXQUM5QlosRUFBRSx1QkFBdUIyQixLQUFLLElBQzlCb0MsY0FBYy9ELEVBQUVtRixNQUFNQyxLQUFLLFNBQzNCcEYsRUFBRSxtQkFBbUJ3QixTQXJMN0IsR0FBTTZELGFBQWMsRUF5TGhCckQsS0FDQXNELEtBQU0sV0FDRnRGLEVBQUV1RixLQUFLeEYsV0FBV3lGLEtBQUssU0FBU0osR0FDNUJqRSxRQUFRQyxJQUFJLGlCQUFpQmdFLE1BQzdCcEQsSUFBSUMsTUFBUW1ELENBQ1osSUFBSXJELEdBQVlxRCxFQUFLbEQsS0FBS1ksTUFBTSxFQUFHdUMsYUFJL0JJLEVBQWNMLEVBQUtsRCxLQUFLd0QsT0FBTyxTQUFTQyxFQUFZaEMsR0FDdkQsTUFBT2dDLEdBQVdDLE9BQU9qQyxFQUFTZSxnQkFHbkN2RCxTQUFRQyxJQUFJcUUsRUFBWSxHQUFHbEUsUUFDM0JTLElBQUk2RCxjQUFnQnpGLGVBQWUsV0FBWXFGLEdBQy9DeEIsY0FBY2xDLEtBR2xCNEMsb0JBS1IzRSxHQUFFOEYsVUFBVUMsTUFBTSxXQUNkL0QsSUFBSXNEIiwiZmlsZSI6Im1haW4ubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5jb25zdCBtYXhfcmVzdWx0cyA9IDU7XG5cbmZ1bmN0aW9uIGdldERhdGEoKSB7XG4gICAgcmV0dXJuICQuYWpheCh7XG4gICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cuZGVza2Jvb2tlcnMuY29tL25sLW5sL3NhamF4Lmpzb24/cT1BbXN0ZXJkYW0mdHlwZT0tJnBlb3BsZT1hbnkmZmF2b3JpdGU9MCZwaWQ9JnN3PTUyLjI5Mzc1MyUyQzQuNjM0OTQyJm5lPTUyLjQ1NTU2MiUyQzUuMTYyMjg2Jmlkcz0xNzIwMSUyQzE5NjQwJTJDMTM2OTIlMkMxMzY5MSUyQzEyMTM2JTJDMTc5MzglMkMxNTI5MiUyQzE0ODg2JTJDMTQ4ODUlMkMxNDg4NCUyQzE0ODgzJTJDMTU3MzAlMkMxNTM1MyUyQzE1MzUxJTJDMTUzMzAlMkMxNTA4MCUyQzE3MjkwJTJDMTU0NTQlMkMxNTQ1MSUyQzE1Mzc5J1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVDYXJvdXNlbChlbGVtZW50LCBpbWFnZV9hcnIpIHtcblxuICAgIHZhciAkY2Fyb3VzZWwgPSAkKGVsZW1lbnQpO1xuICAgICRjYXJvdXNlbC5jdXJyZW50ID0gMDsgLy8gXG4gICAgJGNhcm91c2VsLmltYWdlcyA9IGltYWdlX2FycjtcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZUNvbnRyb2xzKCkge1xuICAgICAgICB2YXIgdGVtcGxhdGUgPSBgXG5cdFx0XHQ8ZGl2IGNsYXNzPVwiY29udHJvbC13cmFwcGVyIGxlZnRcIj5cblx0XHRcdFx0PGRpdiBjbGFzcz1cImNvbnRyb2wgbGVmdC1jb250cm9sXCI+XG5cdFx0XHRcdFx0PGkgY2xhc3M9XCJmYSBmYS1jaGV2cm9uLWxlZnRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0XHQ8ZGl2IGNsYXNzPVwiY29udHJvbC13cmFwcGVyIHJpZ2h0XCI+XG5cdFx0XHRcdDxkaXYgY2xhc3M9XCJjb250cm9sIHJpZ2h0LWNvbnRyb2xcIj5cblx0XHRcdFx0XHQ8aSBjbGFzcz1cImZhIGZhLWNoZXZyb24tcmlnaHRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG5cdFx0XHRcdDwvZGl2PlxuXHRcdFx0PC9kaXY+XG5cdFx0YDtcblxuICAgICAgICAkY2Fyb3VzZWwuYXBwZW5kKHRlbXBsYXRlKTtcblxuICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLnJpZ2h0LWNvbnRyb2wnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRjYXJvdXNlbC5uZXh0SW1hZ2UoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGNhcm91c2VsLmZpbmQoJy5sZWZ0LWNvbnRyb2wnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRjYXJvdXNlbC5wcmV2SW1hZ2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgJGNhcm91c2VsLmdvVG9JbWFnZSA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdHbyB0byBpbWFnZScsIGluZGV4KTtcbiAgICAgICAgJCgnLmNhcm91c2VsLWl0ZW0nKS5mYWRlT3V0KCk7XG4gICAgICAgICQoYC5jYXJvdXNlbC1pdGVtW2RhdGEtaWQ9XCIke2luZGV4fVwiXWApLmZhZGVJbigpO1xuXG4gICAgICAgIGlmICgkY2Fyb3VzZWwuaW1hZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgJGNhcm91c2VsLmZpbmQoJy5jb250cm9sJykuaGlkZSgpO1xuICAgICAgICB9IGVsc2UgaWYgKCRjYXJvdXNlbC5jdXJyZW50ID09PSAwKSB7XG4gICAgICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLmxlZnQtY29udHJvbCcpLmhpZGUoKTtcbiAgICAgICAgICAgICRjYXJvdXNlbC5maW5kKCcucmlnaHQtY29udHJvbCcpLnNob3coKTtcbiAgICAgICAgfSBlbHNlIGlmICgkY2Fyb3VzZWwuY3VycmVudCA9PT0gJGNhcm91c2VsLmltYWdlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLmxlZnQtY29udHJvbCcpLnNob3coKTtcbiAgICAgICAgICAgICRjYXJvdXNlbC5maW5kKCcucmlnaHQtY29udHJvbCcpLmhpZGUoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzaG93IGJvdGgnKTtcbiAgICAgICAgICAgICRjYXJvdXNlbC5maW5kKCcuY29udHJvbCcpLnNob3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRjYXJvdXNlbC51cGRhdGVJbWFnZXMgPSBmdW5jdGlvbihpbWFnZXMpIHtcbiAgICAgICAgJGNhcm91c2VsLmltYWdlcyA9IGltYWdlcztcbiAgICAgICAgJGNhcm91c2VsLmZpbmQoJ3VsJykuaHRtbChcIlwiKTtcbiAgICAgICAgaW1hZ2VzLmZvckVhY2goZnVuY3Rpb24odXJsLCBpbmRleCkge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiB1cmwgPT09ICdzdHJpbmcnKSB7IC8vIFR5cGUgY2hlY2tcbiAgICAgICAgICAgICAgICAkY2Fyb3VzZWwuZmluZCgndWwnKS5hcHBlbmQoYFxuXHRcdFx0XHRcdFx0PGxpIGlkPVwiaW1hZ2UtJHtpbmRleH1cIiBcblx0XHRcdFx0XHRcdFx0ZGF0YS1pZD1cIiR7aW5kZXh9XCIgXG5cdFx0XHRcdFx0XHRcdGNsYXNzPVwiY2Fyb3VzZWwtaXRlbVwiIFxuXHRcdFx0XHRcdFx0XHRzdHlsZT1cImJhY2tncm91bmQtaW1hZ2U6dXJsKCcke3VybH0nKVwiPjwvbGk+XG5cdFx0XHRcdFx0YCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGNhcm91c2VsLmdvVG9JbWFnZSgwKTtcbiAgICB9XG5cbiAgICAkY2Fyb3VzZWwubmV4dEltYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdHbyB0byBpbWFnZScpO1xuICAgICAgICBpZiAoJGNhcm91c2VsLmltYWdlc1skY2Fyb3VzZWwuY3VycmVudCArIDFdKSB7XG4gICAgICAgICAgICAkY2Fyb3VzZWwuZ29Ub0ltYWdlKCRjYXJvdXNlbC5jdXJyZW50KyspO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgJGNhcm91c2VsLnByZXZJbWFnZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJGNhcm91c2VsLmltYWdlc1skY2Fyb3VzZWwuY3VycmVudCAtIDFdKSB7XG4gICAgICAgICAgICAkY2Fyb3VzZWwuZ29Ub0ltYWdlKCRjYXJvdXNlbC5jdXJyZW50LS0pO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY3JlYXRlQ29udHJvbHMoKTtcbiAgICAkY2Fyb3VzZWwuYXBwZW5kKCc8dWw+PC91bD4nKTtcbiAgICAkY2Fyb3VzZWwudXBkYXRlSW1hZ2VzKGltYWdlX2FycilcblxuICAgIHJldHVybiAkY2Fyb3VzZWw7XG59XG5cbmZ1bmN0aW9uIHByZWRpY3RTZWFyY2goc3RyKSB7XG4gICAgbGV0IGxvY2F0aW9ucyA9IGFwcC5tb2RlbC5yb3dzO1xuICAgIGxvY2F0aW9ucy5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcbiAgICBsZXQgcmVzdWx0cyA9IGxvY2F0aW9ucy5maWx0ZXIoZnVuY3Rpb24ocGxhY2UpIHtcbiAgICAgICAgcmV0dXJuIHBsYWNlLm5hbWUudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzdHIudG9Mb3dlckNhc2UoKSk7XG4gICAgfSk7XG4gICAgZmlsbFByZWRpY3RvcignLnByZWRpY3RpdmUtcmVzdWx0cycsIHJlc3VsdHMuc2xpY2UoMCwgNSkpO1xufVxuXG5mdW5jdGlvbiBmaWxsUHJlZGljdG9yKGVsZW1lbnQsIGFycikge1xuICAgIHZhciAkcHJlZGljdG9yID0gJChlbGVtZW50KTtcbiAgICAkcHJlZGljdG9yLmh0bWwoXCJcIik7XG4gICAgY29uc29sZS5sb2coYXJyKTtcbiAgICBmb3IgKGxldCBsb2NhdGlvbiBvZiBhcnIpIHtcbiAgICAgICAgJHByZWRpY3Rvci5hcHBlbmQoYFxuXHRcdFx0PGxpIGRhdGEtaWQ9XCIke2xvY2F0aW9uLmxvY2F0aW9uX2lkfVwiIFxuXHRcdFx0XHRjbGFzcz1cInByZWRpY3RpdmUtaXRlbVwiXG5cdFx0XHRcdGRhdGEtbmFtZT1cIiR7bG9jYXRpb24ubmFtZX1cIj4ke2xvY2F0aW9uLm5hbWV9PC9saT5gKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHByb2Nlc3NTZWFyY2goc3RyKSB7XG4gICAgY29uc29sZS5sb2coc3RyKTtcbiAgICAkKCcjbG9jYXRpb24tc2VhcmNoLWZvcm0gaW5wdXRbdHlwZT1cInRleHRcIl0nKS52YWwoXCJcIik7XG59XG5cbmZ1bmN0aW9uIHVwZGF0ZVJlc3VsdHMobG9jYXRpb25zKSB7XG4gICAgbG9jYXRpb25zLm1hcChmdW5jdGlvbihsb2NhdGlvbiwgaW5kZXgpIHtcbiAgICAgICAgbGV0IHdvcmtwbGFjZSA9IGxvY2F0aW9uLm5hbWU7XG4gICAgICAgIGxldCBsb2NhdGlvbl9uYW1lID0gbG9jYXRpb24ubG9jYXRpb25fbmFtZTtcbiAgICAgICAgbGV0IHJldmlld19zY29yZSA9IGxvY2F0aW9uLnJhdGluZyB8fCBcIi1cIjtcbiAgICAgICAgbGV0IHByaWNlID0gKGxvY2F0aW9uLmRheV9wcmljZSkgPyAnJCcgKyBsb2NhdGlvbi5kYXlfcHJpY2UgKyBcIi9kYXlcIiA6IFwiXCI7XG4gICAgICAgIGxldCBpbWFnZV91cmwgPSBsb2NhdGlvbi5pbWFnZV91cmxzWzBdO1xuXG4gICAgICAgICQoJy5yZXN1bHRzLWxpc3QnKS5hcHBlbmQoYDxsaSBcbiAgICAgICAgXHRpZD1cImxvY2F0aW9uLSR7aW5kZXh9XCIgXG4gICAgICAgIFx0Y2xhc3M9XCJyZXN1bHQtaXRlbVwiIFxuICAgICAgICBcdHN0eWxlPVwiYmFja2dyb3VuZC1pbWFnZTp1cmwoJyR7aW1hZ2VfdXJsfScpXCI+XG5cdFx0XHRcdDx1bCBjbGFzcz1cImxvY2F0aW9uLWluZm9cIj5cblx0XHRcdFx0XHQ8bGk+JHt3b3JrcGxhY2V9PC9saT5cblx0XHRcdFx0XHQ8bGk+JHtsb2NhdGlvbl9uYW1lfTwvbGk+XG5cdFx0XHRcdFx0PGxpPlNjb3JlOiAke3Jldmlld19zY29yZX08L2xpPlxuXHRcdFx0XHRcdDxsaT4ke3ByaWNlfTwvbGk+XG5cdFx0XHRcdDwvdWw+XG5cdFx0XHQ8L2xpPmApO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBzZXRFdmVudEhhbmRsZXJzKCkge1xuICAgIC8vIFNlYXJjaCBmb3JtXG4gICAgJCgnI2xvY2F0aW9uLXNlYXJjaC1mb3JtJykuc3VibWl0KGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgbGV0IHNlYXJjaF9pbnF1aXJ5ID0gJCgnaW5wdXRbdHlwZT1cInRleHRcIl0nKS52YWwoKTtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zb2xlLmxvZyhzZWFyY2hfaW5xdWlyeSk7XG4gICAgICAgIHByb2Nlc3NTZWFyY2goc2VhcmNoX2lucXVpcnkpO1xuICAgICAgICAkKCdpbnB1dFt0eXBlPVwidGV4dFwiXScpLnZhbChcIlwiKTtcbiAgICB9KTtcblxuICAgIC8vIFNlYXJjaCBmb3JtIHByZWRpY3RpdmUgc2VhcmNoXG4gICAgJCgnI2xvY2F0aW9uLXNlYXJjaC1mb3JtIGlucHV0W3R5cGU9XCJ0ZXh0XCJdJykuZm9jdXMoZnVuY3Rpb24oKSB7XG4gICAgICAgICQoJyNsb2NhdGlvbi1zZWFyY2gtZm9ybSBpbnB1dFt0eXBlPVwidGV4dFwiXScpLmtleWRvd24oZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgbGV0IHNlYXJjaF9pbnF1aXJ5ID0gJCgnI2xvY2F0aW9uLXNlYXJjaC1mb3JtIGlucHV0W3R5cGU9XCJ0ZXh0XCJdJykudmFsKCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhzZWFyY2hfaW5xdWlyeSk7XG4gICAgICAgICAgICBwcmVkaWN0U2VhcmNoKHNlYXJjaF9pbnF1aXJ5KTtcbiAgICAgICAgICAgICQoJy5wcmVkaWN0aXZlLWJveCcpLnNob3coKTtcbiAgICAgICAgfSlcbiAgICB9KTtcblxuICAgICQoJyNsb2NhdGlvbi1zZWFyY2gtZm9ybSBpbnB1dFt0eXBlPVwidGV4dFwiXScpLmZvY3VzKGZ1bmN0aW9uKCkge1xuICAgICAgICAkKCcjbG9jYXRpb24tc2VhcmNoLWZvcm0gaW5wdXRbdHlwZT1cInRleHRcIl0nKS5rZXlkb3duKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGxldCBzZWFyY2hfaW5xdWlyeSA9ICQoJyNsb2NhdGlvbi1zZWFyY2gtZm9ybSBpbnB1dFt0eXBlPVwidGV4dFwiXScpLnZhbCgpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coc2VhcmNoX2lucXVpcnkpO1xuICAgICAgICAgICAgcHJlZGljdFNlYXJjaChzZWFyY2hfaW5xdWlyeSk7XG4gICAgICAgICAgICAkKCcucHJlZGljdGl2ZS1ib3gnKS5zaG93KCk7XG4gICAgICAgIH0pXG4gICAgfSk7XG5cbiAgICAkKCcjbG9jYXRpb24tc2VhcmNoLWZvcm0gaW5wdXRbdHlwZT1cInRleHRcIl0nKS5mb2N1c291dChmdW5jdGlvbigpIHtcbiAgICAgICAgJCgnLnByZWRpY3RpdmUtYm94JykuaGlkZSgpO1xuICAgIH0pO1xuXG4gICAgJCgnLnByZWRpY3RpdmUtaXRlbScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAkKCcucHJlZGljdGl2ZS1yZXN1bHRzJykuaHRtbChcIlwiKTtcbiAgICAgICAgcHJvY2Vzc1NlYXJjaCgkKHRoaXMpLmRhdGEoJ25hbWUnKSk7XG4gICAgICAgICQoJy5wcmVkaWN0aXZlLWJveCcpLmhpZGUoKTtcbiAgICB9KVxufVxuXG52YXIgYXBwID0ge1xuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAkLndoZW4oZ2V0RGF0YSgpKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXRyaWV2ZWQgZGF0YScuZGF0YSk7XG4gICAgICAgICAgICBhcHAubW9kZWwgPSBkYXRhO1xuICAgICAgICAgICAgbGV0IGxvY2F0aW9ucyA9IGRhdGEucm93cy5zbGljZSgwLCBtYXhfcmVzdWx0cyk7IC8vIFNob3cgXG4gICAgICAgICAgICAvLyBUaGlzIHdhcyBpbml0aWFsbHkgc2V0IHVwIHRvIGp1c3QgaGF2ZSBhIGNhcm91c2VsIGZvciBvbmUgbG9jYXRpb25cbiAgICAgICAgICAgIC8vIGxldCBtYWluX2ltYWdlcyA9IGxvY2F0aW9uc1swXS5pbWFnZV91cmxzLmNvbmNhdChsb2NhdGlvbnNbMF0uaW1hZ2VfdXJsczIpO1xuXG4gICAgICAgICAgICBsZXQgbWFpbl9pbWFnZXMgPSBkYXRhLnJvd3MucmVkdWNlKGZ1bmN0aW9uKGFsbF9pbWFnZXMsIGxvY2F0aW9uKSB7XG4gICAgICAgICAgICBcdHJldHVybiBhbGxfaW1hZ2VzLmNvbmNhdChsb2NhdGlvbi5pbWFnZV91cmxzKTtcbiAgICAgICAgICAgIH0sIFtdKTtcblxuICAgICAgICAgICAgY29uc29sZS5sb2cobWFpbl9pbWFnZXNbMF0ubGVuZ3RoKTtcbiAgICAgICAgICAgIGFwcC5tYWluX2Nhcm91c2VsID0gY3JlYXRlQ2Fyb3VzZWwoJ2Nhcm91c2VsJywgbWFpbl9pbWFnZXMpO1xuICAgICAgICAgICAgdXBkYXRlUmVzdWx0cyhsb2NhdGlvbnMpO1xuICAgICAgICB9KTtcblxuICAgICAgICBzZXRFdmVudEhhbmRsZXJzKCk7XG4gICAgfSxcblxufVxuXG4kKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcbiAgICBhcHAuaW5pdCgpO1xufSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
