"use strict";function getData(e){return $.ajax({dataType:"json",url:"https://www.deskbookers.com/nl-nl/sajax.json?q=Amsterdam&type=-&people=any&favorite=0&pid=&sw=52.293753%2C4.634942&ne=52.455562%2C5.162286&ids=17201%2C19640%2C13692%2C13691%2C12136%2C17938%2C15292%2C14886%2C14885%2C14884%2C14883%2C15730%2C15353%2C15351%2C15330%2C15080%2C17290%2C15454%2C15451%2C15379"})}function setDimensionsForResponsiveElements(){$("ul.results-list").css("width",$(".result-item").width()*$(".result-item").length+"px")}function createCarousel(e,t){function a(){var e='\n            <div class="control-wrapper left">\n                <div class="control left-control">\n                    <i class="fa fa-chevron-left" aria-hidden="true"></i>\n                </div>\n            </div>\n            <div class="control-wrapper right">\n                <div class="control right-control">\n                    <i class="fa fa-chevron-right" aria-hidden="true"></i>\n                </div>\n            </div>\n        ';n.append(e),n.find(".right-control").on("click",function(){n.nextImage()}),n.find(".left-control").on("click",function(){n.prevImage()})}var n=$(e);return n.current_image_index=0,n.images=t,n.goToImage=function(e){$(".carousel-item").fadeOut(2e3),$('.carousel-item[data-id="'+e+'"]').fadeIn(2e3),0===n.images.length?n.find(".control").hide():n.find(".control").show()},n.updateSlides=function(e,t){n.images=e,n.find("ul").html(""),e.forEach(function(e,a){"string"==typeof e&&n.find("ul").append('<li \n                    id="image-'+a+'" \n                    data-id="'+a+'" \n                    class="carousel-item" \n                    style="background-image:url(\''+e+'\')">\n                        <h1 class="headline">'+(t[a]||"Headline #"+(a+1))+"</h1>\n                    </li>\n                ")}),n.goToImage(0)},n.nextImage=function(){n.images[n.current_image_index+1]?n.goToImage(++n.current_image_index):(n.goToImage(0),n.current_image_index=0)},n.prevImage=function(){n.images[n.current_image_index-1]?n.goToImage(--n.current_image_index):(n.goToImage(n.images.length-1),n.current_image_index=n.images.length-1)},a(),n.append("<ul></ul>"),n.updateSlides(t,["Fast, Easy, Flexible","Book one of our spaces"]),setInterval(function(){n.is(":hover")||n.nextImage()},6e3),n}function updateResults(e){console.log("Update Results",e),e.map(function(e,t){var a=e.url,n=e.name,o=e.location_name,i=e.rating||"-",r=e.day_price?"€"+e.day_price+"/day":"",s=e.hour_price?"€"+e.hour_price+"/hour":"",l=e.image_urls2[0];$(".results-list").append('<li \n            id="location-'+t+'" \n            class="result-item" \n            style="background-image:url(\''+l+'\'); display: none;">\n                <a href="'+(a||"#")+'">\n                    <ul class="location-info">\n                        <li class="first-line">'+n+"</li>\n                        <li>"+o+"</li>\n                        <li>Score: "+i+"</li>\n                        <li>"+r+"</li>\n                        <li>"+s+"</li>\n                    </ul>\n                </a>\n            </li>"),$("#location-"+t).fadeIn(1e3*t)})}function revealResultsArea(){$("html, body").animate({scrollTop:$(".results-section").height()},1e3)}function createResultsArea(){return{update:updateResults,revealResultsArea:revealResultsArea}}function createResultsList(e){var t=app.model.raw_data.rows;if(!e)return t;var a=t.filter(function(t){return t.name===e||t.location_name===e||t.location_city===e});return a}function createSearchList(e){var t={},a=e.reduce(function(e,t){return e.concat([t.name,t.location_name,t.location_city])},[]).filter(function(e){return!t[e]&&(t[e]=!0,!0)});return a.sort(function(e,t){return e.localeCompare(t)}),a}function predictSearch(e){var t=app.model.location_names.filter(function(t){return t.toLowerCase().includes(e.toLowerCase())});fillPredictorBox(".predictive-results",t)}function fillPredictorBox(e,t){var a=$(e);a.html(""),a.append('\n            <li data-id="" \n                class="predictive-item"\n                data-name="All">Search all locations..</li>');var n=!0,o=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value;a.append('\n            <li data-id="" \n                class="predictive-item"\n                data-name="'+l+'">'+l+"</li>")}}catch(c){o=!0,i=c}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw i}}$(".predictive-item").on("click",function(){var e=$(this).data("name");"All"===e?(processSearch(),app.components.results_area.revealResultsArea(),$(".predictive-box").hide()):($('#location-search-form input[type="text"]').val(e),$(".predictive-box").hide())})}function processSearch(e){$(".results-list").html(""),$(".results-section .loader").show(),$('#location-search-form input[type="text"]').val(""),$.when(getData(e)).then(function(t){app.model.raw_data=t,app.model.locations=createResultsList(e),app.components.results_area.update(locations),app.model.locations,setDimensionsForResponsiveElements(),$(".results-section .loader").fadeOut()}).fail(function(t){console.error("Could not connect to API.","Using session storage..",t),app.model.locations=createResultsList(e),app.components.results_area.update(app.model.locations),setDimensionsForResponsiveElements(),$(".results-section .loader").fadeOut()})}function setEventHandlers(){$("#location-search-form").submit(function(e){e.preventDefault();var t=$('input[type="text"]').val();t&&(processSearch(t),$('input[type="text"]').val(""),app.components.results_area.revealResultsArea())}),$('#location-search-form input[type="text"]').focus(function(){$('#location-search-form input[type="text"]').keyup(function(e){var t=$('#location-search-form input[type="text"]').val();predictSearch(t),$(".predictive-box").show(),27==e.keyCode&&($(".predictive-box").hide(),$('#location-search-form input[type="text"]').val(""))})}),$('#location-search-form input[type="text"]').focusout(function(){$(".predictive-box").is(":hover")||$(".predictive-box").hide()}),$(".predictive-item").on("click",function(){$(".predictive-results").html(""),$(this).data("name"),$(".predictive-box").hide()})}var max_results=20,app={model:{raw_data:void 0,locations:void 0,location_names:void 0},components:{main_carousel:void 0,results_area:{update:void 0,revealResultsArea:void 0}},init:function(){if(sessionStorage.getItem("location_data")){var e=sessionStorage.getItem("location_data");app.model.raw_data=JSON.parse(e),console.log("Using data from session storage..",app.model.raw_data),app.setUp()}else $(".loader").show(),app.setData()},setData:function(){$.when(getData()).then(function(e){console.log("Retrieved data",e),sessionStorage.setItem("location_data",JSON.stringify(e)),app.model.raw_data=e,app.setUp(),$(".loader").fadeOut()})},setUp:function(){app.model.locations=app.model.raw_data.rows;var e=app.model.locations.slice(0,Math.min(max_results,app.model.locations.length-1)),t=app.model.locations.reduce(function(e,t){return e.concat(t.image_urls)},[]);$(document).ready(function(){app.model.location_names=createSearchList(app.model.raw_data.rows),app.components.main_carousel=createCarousel("carousel",t),app.components.results_area=createResultsArea(),app.components.results_area.update(e),$(".search-box").show(),setEventHandlers(),setDimensionsForResponsiveElements()})}};app.init(),$(window).resize(function(){setDimensionsForResponsiveElements()});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2UuanMiLCJjcmVhdGVDYXJvdXNlbC5qcyIsImNyZWF0ZVJlc3VsdHNBcmVhLmpzIiwic2VhcmNoX2Z1bmN0aW9ucy5qcyIsInNldEV2ZW50SGFuZGxlcnMuanMiXSwibmFtZXMiOlsiZ2V0RGF0YSIsInNlYXJjaF9pbnF1aXJ5IiwiJCIsImFqYXgiLCJkYXRhVHlwZSIsInVybCIsInNldERpbWVuc2lvbnNGb3JSZXNwb25zaXZlRWxlbWVudHMiLCJjc3MiLCJ3aWR0aCIsImxlbmd0aCIsImNyZWF0ZUNhcm91c2VsIiwic2VsZWN0b3IiLCJpbWFnZV9hcnIiLCJjcmVhdGVDb250cm9scyIsInRlbXBsYXRlIiwiJGNhcm91c2VsIiwiYXBwZW5kIiwiZmluZCIsIm9uIiwibmV4dEltYWdlIiwicHJldkltYWdlIiwiY3VycmVudF9pbWFnZV9pbmRleCIsImltYWdlcyIsImdvVG9JbWFnZSIsImluZGV4IiwiZmFkZU91dCIsImZhZGVJbiIsImhpZGUiLCJzaG93IiwidXBkYXRlU2xpZGVzIiwic2xpZGVzIiwiaGVhZGxpbmVzIiwiaHRtbCIsImZvckVhY2giLCJzZXRJbnRlcnZhbCIsImlzIiwidXBkYXRlUmVzdWx0cyIsImxvY2F0aW9ucyIsImNvbnNvbGUiLCJsb2ciLCJtYXAiLCJsb2NhdGlvbiIsImxvY2F0aW9uX3VybCIsIndvcmtwbGFjZSIsIm5hbWUiLCJsb2NhdGlvbl9uYW1lIiwicmV2aWV3X3Njb3JlIiwicmF0aW5nIiwiZGF5X3ByaWNlIiwiaG91cl9wcmljZSIsImltYWdlX3VybCIsImltYWdlX3VybHMyIiwicmV2ZWFsUmVzdWx0c0FyZWEiLCJhbmltYXRlIiwic2Nyb2xsVG9wIiwiaGVpZ2h0IiwiY3JlYXRlUmVzdWx0c0FyZWEiLCJ1cGRhdGUiLCJjcmVhdGVSZXN1bHRzTGlzdCIsInN0ciIsImFwcCIsIm1vZGVsIiwicmF3X2RhdGEiLCJyb3dzIiwicmVzdWx0cyIsImZpbHRlciIsImxvY2F0aW9uX2NpdHkiLCJjcmVhdGVTZWFyY2hMaXN0IiwicGxhY2VfaGFzaCIsImxvY2F0aW9uX25hbWVzIiwicmVkdWNlIiwiYWxsX25hbWVzIiwiY29uY2F0IiwiaXRlbSIsInNvcnQiLCJhIiwiYiIsImxvY2FsZUNvbXBhcmUiLCJwcmVkaWN0U2VhcmNoIiwibGlzdCIsInBsYWNlIiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsImZpbGxQcmVkaWN0b3JCb3giLCIkcHJlZGljdG9yIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJ1bmRlZmluZWQiLCJfc3RlcCIsIl9pdGVyYXRvciIsIlN5bWJvbCIsIml0ZXJhdG9yIiwibmV4dCIsImRvbmUiLCJ2YWx1ZSIsImVyciIsInRoaXMiLCJkYXRhIiwicHJvY2Vzc1NlYXJjaCIsImNvbXBvbmVudHMiLCJyZXN1bHRzX2FyZWEiLCJ2YWwiLCJ3aGVuIiwidGhlbiIsImZhaWwiLCJlcnJvciIsInNldEV2ZW50SGFuZGxlcnMiLCJzdWJtaXQiLCJlIiwicHJldmVudERlZmF1bHQiLCJmb2N1cyIsImtleXVwIiwia2V5Q29kZSIsImZvY3Vzb3V0IiwibWF4X3Jlc3VsdHMiLCJtYWluX2Nhcm91c2VsIiwiaW5pdCIsInNlc3Npb25TdG9yYWdlIiwiZ2V0SXRlbSIsImRhdGFTdHJpbmciLCJKU09OIiwicGFyc2UiLCJzZXRVcCIsInNldERhdGEiLCJzZXRJdGVtIiwic3RyaW5naWZ5Iiwic2xpY2UiLCJNYXRoIiwibWluIiwibWFpbl9pbWFnZXMiLCJhbGxfaW1hZ2VzIiwiaW1hZ2VfdXJscyIsImRvY3VtZW50IiwicmVhZHkiLCJ3aW5kb3ciLCJyZXNpemUiXSwibWFwcGluZ3MiOiJBQUFBLFlBSUEsU0FBU0EsU0FBUUMsR0FHYixNQUFPQyxHQUFFQyxNQUNMQyxTQUFVLE9BQ1ZDLElBQUssaVRBSWIsUUFBU0Msc0NBSUxKLEVBQUUsbUJBQW1CSyxJQUFJLFFBQVNMLEVBQUUsZ0JBQWdCTSxRQUFVTixFQUFFLGdCQUFnQk8sT0FBUyxN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RCxFQUFZMUYsR0FDOUQsTUFBTzBGLEdBQVczRCxPQUFPL0IsRUFBUzJGLGdCQUl0Q2xJLEdBQUVtSSxVQUFVQyxNQUFNLFdBQ2QxRSxJQUFJQyxNQUFNUSxlQUFpQkYsaUJBQWlCUCxJQUFJQyxNQUFNQyxTQUFTQyxNQUMvREgsSUFBSXdDLFdBQVdnQixjQUFnQjFHLGVBQWUsV0FBWXdILEdBQzFEdEUsSUFBSXdDLFdBQVdDLGFBQWU3QyxvQkFDOUJJLElBQUl3QyxXQUFXQyxhQUFhNUMsT0FBT3BCLEdBQ25DbkMsRUFBRSxlQUFlMEIsT0FDakIrRSxtQkFDQXJHLHdDQU1ac0QsS0FBSXlELE9BQ0puSCxFQUFFcUksUUFBUUMsT0FBTyxXQUNibEkiLCJmaWxlIjoibWFpbi5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IG1heF9yZXN1bHRzID0gMjA7IC8vVXNlIHRoaXMgbnVtYmVyIHRvIGNhcCB0aGUgYW1vdW50IG9mIGRhdGEgYmVpbmcgcmVxdWVzdGVkIGZyb20gQVBJXG5cbmZ1bmN0aW9uIGdldERhdGEoc2VhcmNoX2lucXVpcnkpIHtcbiAgICAvLyBTZWFyY2ggaW5xdWlyeSB3b3VsZCBiZSB1c2VkIHRvIGdldCBzcGVjaWZpYyByZXN1bHRzIGZyb20gQVBJXG4gICAgLy8gRm9yIHRoaXMgY2hhbGxlbmdlLCBvbmx5IHVzaW5nIHNwZWNpZmllZCBxdWVyeSBzdHJpbmcgYmVsb3c6XG4gICAgcmV0dXJuICQuYWpheCh7XG4gICAgICAgIGRhdGFUeXBlOiBcImpzb25cIixcbiAgICAgICAgdXJsOiAnaHR0cHM6Ly93d3cuZGVza2Jvb2tlcnMuY29tL25sLW5sL3NhamF4Lmpzb24/cT1BbXN0ZXJkYW0mdHlwZT0tJnBlb3BsZT1hbnkmZmF2b3JpdGU9MCZwaWQ9JnN3PTUyLjI5Mzc1MyUyQzQuNjM0OTQyJm5lPTUyLjQ1NTU2MiUyQzUuMTYyMjg2Jmlkcz0xNzIwMSUyQzE5NjQwJTJDMTM2OTIlMkMxMzY5MSUyQzEyMTM2JTJDMTc5MzglMkMxNTI5MiUyQzE0ODg2JTJDMTQ4ODUlMkMxNDg4NCUyQzE0ODgzJTJDMTU3MzAlMkMxNTM1MyUyQzE1MzUxJTJDMTUzMzAlMkMxNTA4MCUyQzE3MjkwJTJDMTU0NTQlMkMxNTQ1MSUyQzE1Mzc5J1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBzZXREaW1lbnNpb25zRm9yUmVzcG9uc2l2ZUVsZW1lbnRzKCkge1xuICAgIC8vIFNldCB3aWR0aCBvZiByZXN1bHRzIGxpc3QgYnkgZmlndXJpbmcgb3V0IDEvNSBvZiB3aW5kb3cgd2lkdGggXG4gICAgLy8gdGhlbiBtdWx0aXBseWluZyB0aGF0IGJ5IHRoZSBudW1iZXIgb2YgaXRlbXNcbiAgICAvLyBHaXZlc1xuICAgICQoJ3VsLnJlc3VsdHMtbGlzdCcpLmNzcygnd2lkdGgnLCAkKCcucmVzdWx0LWl0ZW0nKS53aWR0aCgpICogJCgnLnJlc3VsdC1pdGVtJykubGVuZ3RoICsgJ3B4Jyk7XG59XG5cbnZhciBhcHAgPSB7XG4gICAgLy8gSW5pdGlhbGl6ZSB0aGUgYXBwXG4gICAgLy8gVGhpcyBsYXlzIG91dCB0aGUgc3RydWN0dXJlIGFzIGEgcmVmZXJlbmNlXG4gICAgbW9kZWw6IHtcbiAgICAgICAgcmF3X2RhdGE6IHVuZGVmaW5lZCwgLy9BbGwgZGF0YSBmcm9tIHNlcnZlclxuICAgICAgICBsb2NhdGlvbnM6IHVuZGVmaW5lZCwgLy9DdXJyZW50IHJlc3VsdCBkYXRhXG4gICAgICAgIGxvY2F0aW9uX25hbWVzOiB1bmRlZmluZWQgLy9Qb3NzaWJsZSBzZWFyY2ggcmVzdWx0c1xuICAgIH0sXG4gICAgY29tcG9uZW50czoge1xuICAgICAgICBtYWluX2Nhcm91c2VsOiB1bmRlZmluZWQsIC8vIFxuICAgICAgICByZXN1bHRzX2FyZWE6IHtcbiAgICAgICAgICAgIHVwZGF0ZTogdW5kZWZpbmVkLCAvLyBVcGRhdGUgcmVzdWx0cyBhcmVhXG4gICAgICAgICAgICByZXZlYWxSZXN1bHRzQXJlYTogdW5kZWZpbmVkIC8vIFNjcm9sbCBkb3duIHRvIHJldmVhbCByZXN1bHRzXG4gICAgICAgIH1cbiAgICB9LFxuICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBJbml0IGFwcC4gU3RhcnQgb2ZmIGJ5IGdldHRpbmcgZGF0YSBmcm9tIEFQSSB1cmwgcHJvdmlkZWRcbiAgICAgICAgLy8gaW4gUmVhZE1lLiBVc2UgdGhpcyB0byBwb3B1bGF0ZSByZXN1bHRzIGFuZCBjYXJvdXNlbC5cbiAgICAgICAgLy8gVXNlIHNlc3Npb24gc3RvcmFnZSBpZiBhdmFpbGFibGVcbiAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ2xvY2F0aW9uX2RhdGEnKSkge1xuICAgICAgICAgICAgLy8gR2V0IGRhdGEgZnJvbSBzZXNzaW9uIHN0b3JhZ2UgYXMgc3RyaW5nXG4gICAgICAgICAgICBsZXQgZGF0YVN0cmluZyA9IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ2xvY2F0aW9uX2RhdGEnKTtcbiAgICAgICAgICAgIC8vIFBhcnNlIHRvIEpTT04gZm9yIHVzZSBpbiBhcHBcbiAgICAgICAgICAgIGFwcC5tb2RlbC5yYXdfZGF0YSA9IEpTT04ucGFyc2UoZGF0YVN0cmluZyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnVXNpbmcgZGF0YSBmcm9tIHNlc3Npb24gc3RvcmFnZS4uJywgYXBwLm1vZGVsLnJhd19kYXRhKTtcbiAgICAgICAgICAgIC8vIE5vdyB0aGF0IGRhdGEgaXMgc2V0LCBzZXQgdXBcbiAgICAgICAgICAgIGFwcC5zZXRVcCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gU2hvdyBsb2FkZXIgd2hpbGUgd2FpdGluZyBmb3IgYXBpXG4gICAgICAgICAgICAkKCcubG9hZGVyJykuc2hvdygpO1xuICAgICAgICAgICAgYXBwLnNldERhdGEoKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9XG4gICAgfSxcbiAgICAvLyBHZXQgYW5kIHNldCBkYXRhIGZyb20gdGhlIEFQSVxuICAgIHNldERhdGE6IGZ1bmN0aW9uKCkge1xuICAgICAgICAkLndoZW4oZ2V0RGF0YSgpKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXRyaWV2ZWQgZGF0YScsIGRhdGEpO1xuICAgICAgICAgICAgLy8gU3RvcmUgZGF0YSBpbnRvIHNlc3Npb25zIHN0b3JhZ2VcbiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2xvY2F0aW9uX2RhdGEnLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7XG4gICAgICAgICAgICBhcHAubW9kZWwucmF3X2RhdGEgPSBkYXRhO1xuICAgICAgICAgICAgYXBwLnNldFVwKCk7XG4gICAgICAgICAgICAvLyBPbmNlIGV2ZXJ5dGhpbmcgaXMgbG9hZGVkLCBmYWRlIGxvYWRlclxuICAgICAgICAgICAgJCgnLmxvYWRlcicpLmZhZGVPdXQoKTtcbiAgICAgICAgfSk7XG4gICAgfSxcbiAgICAvLyBTZXQgdXAgdmlld3NcbiAgICBzZXRVcDogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFNldCByZXN1bHQgZGF0YSBmcm9tIGFsbCBkYXRhXG4gICAgICAgIGFwcC5tb2RlbC5sb2NhdGlvbnMgPSBhcHAubW9kZWwucmF3X2RhdGEucm93cztcbiAgICAgICAgdmFyIGxvY2F0aW9ucyA9IGFwcC5tb2RlbC5sb2NhdGlvbnMuc2xpY2UoMCwgTWF0aC5taW4obWF4X3Jlc3VsdHMsIGFwcC5tb2RlbC5sb2NhdGlvbnMubGVuZ3RoIC0gMSkpO1xuXG4gICAgICAgIC8vIFRoaXMgd2FzIGluaXRpYWxseSBzZXQgdXAgdG8ganVzdCBoYXZlIGEgY2Fyb3VzZWwgZm9yIG9uZSBsb2NhdGlvblxuICAgICAgICAvLyB2YXIgbWFpbl9pbWFnZXMgPSBsb2NhdGlvbnNbMF0uaW1hZ2VfdXJscy5jb25jYXQobG9jYXRpb25zWzBdLmltYWdlX3VybHMyKTtcblxuICAgICAgICB2YXIgbWFpbl9pbWFnZXMgPSBhcHAubW9kZWwubG9jYXRpb25zLnJlZHVjZShmdW5jdGlvbihhbGxfaW1hZ2VzLCBsb2NhdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIGFsbF9pbWFnZXMuY29uY2F0KGxvY2F0aW9uLmltYWdlX3VybHMpO1xuICAgICAgICB9LCBbXSk7XG5cbiAgICAgICAgLy8gV2FpdCBmb3IgdGhlIGRvY3VtZXQgcmVhZHkgYmVmb3JlIGJ1aWxkaW5nIHZpZXdzXG4gICAgICAgICQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgYXBwLm1vZGVsLmxvY2F0aW9uX25hbWVzID0gY3JlYXRlU2VhcmNoTGlzdChhcHAubW9kZWwucmF3X2RhdGEucm93cyk7XG4gICAgICAgICAgICBhcHAuY29tcG9uZW50cy5tYWluX2Nhcm91c2VsID0gY3JlYXRlQ2Fyb3VzZWwoJ2Nhcm91c2VsJywgbWFpbl9pbWFnZXMpO1xuICAgICAgICAgICAgYXBwLmNvbXBvbmVudHMucmVzdWx0c19hcmVhID0gY3JlYXRlUmVzdWx0c0FyZWEoKTtcbiAgICAgICAgICAgIGFwcC5jb21wb25lbnRzLnJlc3VsdHNfYXJlYS51cGRhdGUobG9jYXRpb25zKTtcbiAgICAgICAgICAgICQoJy5zZWFyY2gtYm94Jykuc2hvdygpO1xuICAgICAgICAgICAgc2V0RXZlbnRIYW5kbGVycygpO1xuICAgICAgICAgICAgc2V0RGltZW5zaW9uc0ZvclJlc3BvbnNpdmVFbGVtZW50cygpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG5cbi8vIFN0YXJ0IHByb2Nlc3NcbmFwcC5pbml0KCk7XG4kKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKCkge1xuICAgIHNldERpbWVuc2lvbnNGb3JSZXNwb25zaXZlRWxlbWVudHMoKTtcbn0pXG4iLCJmdW5jdGlvbiBjcmVhdGVDYXJvdXNlbChzZWxlY3RvciwgaW1hZ2VfYXJyKSB7XG5cbiAgICAvLyBJbml0aWFsaXplIHZhbHVlIGZvciBjYXJvdXNlbCBlbGVtZW50IHdpdGggc2VsZWN0b3JcbiAgICB2YXIgJGNhcm91c2VsID0gJChzZWxlY3Rvcik7XG4gICAgJGNhcm91c2VsLmN1cnJlbnRfaW1hZ2VfaW5kZXggPSAwO1xuICAgICRjYXJvdXNlbC5pbWFnZXMgPSBpbWFnZV9hcnI7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDb250cm9scygpIHtcblxuICAgICAgICAvLyBIVE1MIHRlbXBsYXRlIGZvciBjYXJvdXNlbCBjb250cm9sc1xuICAgICAgICB2YXIgdGVtcGxhdGUgPSBgXG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29udHJvbC13cmFwcGVyIGxlZnRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29udHJvbCBsZWZ0LWNvbnRyb2xcIj5cbiAgICAgICAgICAgICAgICAgICAgPGkgY2xhc3M9XCJmYSBmYS1jaGV2cm9uLWxlZnRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJjb250cm9sLXdyYXBwZXIgcmlnaHRcIj5cbiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29udHJvbCByaWdodC1jb250cm9sXCI+XG4gICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmEgZmEtY2hldnJvbi1yaWdodFwiIGFyaWEtaGlkZGVuPVwidHJ1ZVwiPjwvaT5cbiAgICAgICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICBgO1xuXG4gICAgICAgIC8vIEFkZCBjb250cm9scyBIVE1MIHRvIGNhcm91c2VsXG4gICAgICAgICRjYXJvdXNlbC5hcHBlbmQodGVtcGxhdGUpO1xuXG4gICAgICAgICAvLyBTZXQgZXZlbnQgaGFuZGxlcnMgZm9yIGNsaWNrIHByb2dyZXNzIHNsaWRlc1xuICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLnJpZ2h0LWNvbnRyb2wnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRjYXJvdXNlbC5uZXh0SW1hZ2UoKTtcbiAgICAgICAgfSk7XG4gICAgICAgICRjYXJvdXNlbC5maW5kKCcubGVmdC1jb250cm9sJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkY2Fyb3VzZWwucHJldkltYWdlKCk7XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgICRjYXJvdXNlbC5nb1RvSW1hZ2UgPSBmdW5jdGlvbihpbmRleCkge1xuXG4gICAgICAgIC8vIEdvIHRvIG5ldyBpbWFnZSB3aXRoIGdpdmVuIGluZGV4XG4gICAgICAgIC8vIEZhZGUgb3V0IGFsbCBpdGVtcyAtIGZhaWxzYWZlXG4gICAgICAgICQoJy5jYXJvdXNlbC1pdGVtJykuZmFkZU91dCgyMDAwKTtcblxuICAgICAgICAvLyBGYWRlIGluIHNwZWNpZmljIHNsaWRlXG4gICAgICAgICQoYC5jYXJvdXNlbC1pdGVtW2RhdGEtaWQ9XCIke2luZGV4fVwiXWApLmZhZGVJbigyMDAwKTtcblxuICAgICAgICAvLyBJZiBubyBzbGlkZXMsIGhpZGUgdXNlbGVzcyBjb250cm9sc1xuICAgICAgICBpZiAoJGNhcm91c2VsLmltYWdlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICRjYXJvdXNlbC5maW5kKCcuY29udHJvbCcpLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgICAvKlxuICAgICAgICAvLyBUaGVzZSBjb25kaXRpb25hbHMgdW5uZWNlc3Nhcnkgd2l0aCBuZXcgXG4gICAgICAgIC8vIGxvb3BpbmcgZmVhdHVyZSBJJ3ZlIGltcGxpbWVudGVkXG4gICAgICAgIGVsc2UgaWYgKCRjYXJvdXNlbC5jdXJyZW50X2ltYWdlX2luZGV4ID09PSAwKSB7XG4gICAgICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLmxlZnQtY29udHJvbCcpLmhpZGUoKTtcbiAgICAgICAgICAgICRjYXJvdXNlbC5maW5kKCcucmlnaHQtY29udHJvbCcpLnNob3coKTtcbiAgICAgICAgfSBlbHNlIGlmICgkY2Fyb3VzZWwuY3VycmVudF9pbWFnZV9pbmRleCA9PT0gJGNhcm91c2VsLmltYWdlcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLmxlZnQtY29udHJvbCcpLnNob3coKTtcbiAgICAgICAgICAgICRjYXJvdXNlbC5maW5kKCcucmlnaHQtY29udHJvbCcpLmhpZGUoKTtcbiAgICAgICAgfSBcbiAgICAgICAgKi9cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAvLyBTaG93IGNvbnRyb2xzIGlmIHRoZXJlIGFyZSBpbWFnZXMgLy8gZmFpbHNhZmVcbiAgICAgICAgICAgICRjYXJvdXNlbC5maW5kKCcuY29udHJvbCcpLnNob3coKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgICRjYXJvdXNlbC51cGRhdGVTbGlkZXMgPSBmdW5jdGlvbihzbGlkZXMsIGhlYWRsaW5lcykge1xuICAgICAgICAvLyBVcGRhdGUgY2Fyb3VzZWwgc2xpZGVzXG4gICAgICAgIC8vIENhbiBiZSB1c2VkIHRvIHVwZGF0ZSBzbGlkZXMgd2l0aCBuZXcgaW1hZ2VzIGFuZCBuZXcgaGVhZGxpbmVzXG4gICAgICAgICRjYXJvdXNlbC5pbWFnZXMgPSBzbGlkZXM7XG4gICAgICAgICRjYXJvdXNlbC5maW5kKCd1bCcpLmh0bWwoXCJcIik7XG4gICAgICAgIHNsaWRlcy5mb3JFYWNoKGZ1bmN0aW9uKHVybCwgaW5kZXgpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdXJsID09PSAnc3RyaW5nJykgeyAvLyBUeXBlIGNoZWNrXG4gICAgICAgICAgICAgICAgJGNhcm91c2VsLmZpbmQoJ3VsJykuYXBwZW5kKGA8bGkgXG4gICAgICAgICAgICAgICAgICAgIGlkPVwiaW1hZ2UtJHtpbmRleH1cIiBcbiAgICAgICAgICAgICAgICAgICAgZGF0YS1pZD1cIiR7aW5kZXh9XCIgXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiY2Fyb3VzZWwtaXRlbVwiIFxuICAgICAgICAgICAgICAgICAgICBzdHlsZT1cImJhY2tncm91bmQtaW1hZ2U6dXJsKCcke3VybH0nKVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGgxIGNsYXNzPVwiaGVhZGxpbmVcIj4ke2hlYWRsaW5lc1tpbmRleF0gfHwgXCJIZWFkbGluZSAjXCIgKyAoaW5kZXgrMSl9PC9oMT5cbiAgICAgICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICBgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGNhcm91c2VsLmdvVG9JbWFnZSgwKTtcbiAgICB9XG5cbiAgICAkY2Fyb3VzZWwubmV4dEltYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICgkY2Fyb3VzZWwuaW1hZ2VzWyRjYXJvdXNlbC5jdXJyZW50X2ltYWdlX2luZGV4ICsgMV0pIHtcbiAgICAgICAgICAgICRjYXJvdXNlbC5nb1RvSW1hZ2UoKyskY2Fyb3VzZWwuY3VycmVudF9pbWFnZV9pbmRleCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBMb29wXG4gICAgICAgICAgICAkY2Fyb3VzZWwuZ29Ub0ltYWdlKDApO1xuICAgICAgICAgICAgJGNhcm91c2VsLmN1cnJlbnRfaW1hZ2VfaW5kZXggPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgJGNhcm91c2VsLnByZXZJbWFnZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJGNhcm91c2VsLmltYWdlc1skY2Fyb3VzZWwuY3VycmVudF9pbWFnZV9pbmRleCAtIDFdKSB7XG4gICAgICAgICAgICAkY2Fyb3VzZWwuZ29Ub0ltYWdlKC0tJGNhcm91c2VsLmN1cnJlbnRfaW1hZ2VfaW5kZXgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gTG9vcFxuICAgICAgICAgICAgJGNhcm91c2VsLmdvVG9JbWFnZSgkY2Fyb3VzZWwuaW1hZ2VzLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgJGNhcm91c2VsLmN1cnJlbnRfaW1hZ2VfaW5kZXggPSAkY2Fyb3VzZWwuaW1hZ2VzLmxlbmd0aCAtIDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjcmVhdGVDb250cm9scygpO1xuICAgICRjYXJvdXNlbC5hcHBlbmQoJzx1bD48L3VsPicpOyAvLyBTZXQgdWwgdG8gcmVjZWl2ZSBsaSBlbGVtZW50c1xuICAgICRjYXJvdXNlbC51cGRhdGVTbGlkZXMoaW1hZ2VfYXJyLCBbXCJGYXN0LCBFYXN5LCBGbGV4aWJsZVwiLCBcIkJvb2sgb25lIG9mIG91ciBzcGFjZXNcIl0pO1xuICAgIFxuICAgIC8vIFNldHMgdXAgYXV0byBwbGF5XG4gICAgc2V0SW50ZXJ2YWwoZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghJGNhcm91c2VsLmlzKFwiOmhvdmVyXCIpKSB7XG4gICAgICAgICAgICAkY2Fyb3VzZWwubmV4dEltYWdlKCk7XG4gICAgICAgIH1cbiAgICB9LCA2MDAwKTtcbiAgICBcbiAgICByZXR1cm4gJGNhcm91c2VsO1xufSIsImZ1bmN0aW9uIHVwZGF0ZVJlc3VsdHMobG9jYXRpb25zKSB7XG4gICAgLy8gRmlsbCByZXN1bHRzIGRpdlxuICAgIGNvbnNvbGUubG9nKCdVcGRhdGUgUmVzdWx0cycsIGxvY2F0aW9ucyk7XG5cbiAgICAvLyBJdGVyYXRlIHRocm91Z2ggcmV0dXJuZWQgcmVzdWx0cyBhbmQgdXNlIGxpc3QgdG8gXG4gICAgLy8gcG9wdWxhdGUgcmVzdWx0cyBzZWN0aW9uXG4gICAgbG9jYXRpb25zLm1hcChmdW5jdGlvbihsb2NhdGlvbiwgaW5kZXgpIHtcbiAgICAgICAgbGV0IGxvY2F0aW9uX3VybCA9IGxvY2F0aW9uLnVybDtcbiAgICAgICAgbGV0IHdvcmtwbGFjZSA9IGxvY2F0aW9uLm5hbWU7XG4gICAgICAgIGxldCBsb2NhdGlvbl9uYW1lID0gbG9jYXRpb24ubG9jYXRpb25fbmFtZTtcbiAgICAgICAgbGV0IHJldmlld19zY29yZSA9IGxvY2F0aW9uLnJhdGluZyB8fCBcIi1cIjtcbiAgICAgICAgbGV0IGRheV9wcmljZSA9IChsb2NhdGlvbi5kYXlfcHJpY2UpID8gJ+KCrCcgKyBsb2NhdGlvbi5kYXlfcHJpY2UgKyBcIi9kYXlcIiA6IFwiXCI7XG4gICAgICAgIGxldCBob3VyX3ByaWNlID0gKGxvY2F0aW9uLmhvdXJfcHJpY2UpID8gJ+KCrCcgKyBsb2NhdGlvbi5ob3VyX3ByaWNlICsgXCIvaG91clwiIDogXCJcIjtcbiAgICAgICAgbGV0IGltYWdlX3VybCA9IGxvY2F0aW9uLmltYWdlX3VybHMyWzBdOyAvLyBVc2Ugc21hbGxlciB0aHVtYnNcblxuICAgICAgICAkKCcucmVzdWx0cy1saXN0JykuYXBwZW5kKGA8bGkgXG4gICAgICAgICAgICBpZD1cImxvY2F0aW9uLSR7aW5kZXh9XCIgXG4gICAgICAgICAgICBjbGFzcz1cInJlc3VsdC1pdGVtXCIgXG4gICAgICAgICAgICBzdHlsZT1cImJhY2tncm91bmQtaW1hZ2U6dXJsKCcke2ltYWdlX3VybH0nKTsgZGlzcGxheTogbm9uZTtcIj5cbiAgICAgICAgICAgICAgICA8YSBocmVmPVwiJHtsb2NhdGlvbl91cmwgfHwgXCIjXCJ9XCI+XG4gICAgICAgICAgICAgICAgICAgIDx1bCBjbGFzcz1cImxvY2F0aW9uLWluZm9cIj5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaSBjbGFzcz1cImZpcnN0LWxpbmVcIj4ke3dvcmtwbGFjZX08L2xpPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGxpPiR7bG9jYXRpb25fbmFtZX08L2xpPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGxpPlNjb3JlOiAke3Jldmlld19zY29yZX08L2xpPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGxpPiR7ZGF5X3ByaWNlfTwvbGk+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bGk+JHtob3VyX3ByaWNlfTwvbGk+XG4gICAgICAgICAgICAgICAgICAgIDwvdWw+XG4gICAgICAgICAgICAgICAgPC9hPlxuICAgICAgICAgICAgPC9saT5gKTtcbiAgICAgICAgJCgnI2xvY2F0aW9uLScraW5kZXgpLmZhZGVJbigxMDAwICogaW5kZXgpOyAvLyBDcmVhdGVzIGNvb2wgcHJvZ3Jlc3NpdmUgZmFkZSBpblxuICAgIH0pO1xufVxuXG5mdW5jdGlvbiByZXZlYWxSZXN1bHRzQXJlYSgpIHtcbiAgICAvLyBTY3JvbGwgZG93biB0byBkaXNwbGF5IHJlc3VsdHNcbiAgICAkKCdodG1sLCBib2R5JykuYW5pbWF0ZSh7XG4gICAgICAgIHNjcm9sbFRvcDogJChcIi5yZXN1bHRzLXNlY3Rpb25cIikuaGVpZ2h0KClcbiAgICAgfSwgMTAwMCk7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVJlc3VsdHNBcmVhKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIHVwZGF0ZTogdXBkYXRlUmVzdWx0cyxcbiAgICAgICAgcmV2ZWFsUmVzdWx0c0FyZWE6IHJldmVhbFJlc3VsdHNBcmVhXG4gICAgfVxufSIsImZ1bmN0aW9uIGNyZWF0ZVJlc3VsdHNMaXN0KHN0cikge1xuICAgIC8vIENyZWF0ZSBhIG5ldyBhcnJheSBvZiBsb2NhdGlvbnMgdGhhdCBtYXRjaCBzZWFyY2ggcXVlcnlcbiAgICAvLyBUaGlzIGlzIGEgaGVscGVyIGZ1bmN0aW9uIHRvIHNpbXVsYXRlIG5ldyBzZWFyY2ggcmVzdWx0c1xuICAgIC8vIElmIGEgZnVsbCBBUEkgd2FzIHVzZWQsIHdlIHdvdWxkbid0IG5lZWQgdGhpcyBmdW5jdGlvblxuICAgIC8vIGFzIHdlIHdvdWxkIGhhdmUgXCJmaWx0ZXJlZFwiIHJlc3VsdHMgYWxyZWFkeSBmcm9tIEFQSSBwYXlsb2FkXG4gICAgbGV0IGxvY2F0aW9ucyA9IGFwcC5tb2RlbC5yYXdfZGF0YS5yb3dzO1xuICAgIGlmICghc3RyKSByZXR1cm4gbG9jYXRpb25zOyAvLyBJZiBubyBzZWFyY2ggY3JpdGVyaWEsIHJldHVybiB3aG9sZSBsaXN0XG4gICAgbGV0IHJlc3VsdHMgPSBsb2NhdGlvbnMuZmlsdGVyKGZ1bmN0aW9uKGxvY2F0aW9uKSB7XG4gICAgICAgIGlmKGxvY2F0aW9uLm5hbWUgPT09IHN0ciB8fCBcbiAgICAgICAgICAgbG9jYXRpb24ubG9jYXRpb25fbmFtZSA9PT0gc3RyIHx8XG4gICAgICAgICAgIGxvY2F0aW9uLmxvY2F0aW9uX2NpdHkgPT09IHN0cikge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIHJldHVybiByZXN1bHRzO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVTZWFyY2hMaXN0KGxvY2F0aW9ucykge1xuICAgIC8vIFRha2VzIGFuIGFycmF5IG9mIGxvY2F0aW9uc1xuICAgIC8vIDEuIFJlZHVjZSB0byBuZXcgbGlzdCBqdXN0IG9mIGxvY2F0aW9uIG5hbWVzIG9mIHZhcmlvdXMgdHlwZVxuICAgIC8vIDIuIFJlbW92ZSBhbGwgZHVwbGljYXRlc1xuICAgIC8vIDMuIFNvcnRcbiAgICAvLyA0LiBSZXR1cm4gbGlzdFxuICAgIGxldCBwbGFjZV9oYXNoID0ge307XG4gICAgbGV0IGxvY2F0aW9uX25hbWVzID0gbG9jYXRpb25zLnJlZHVjZShmdW5jdGlvbihhbGxfbmFtZXMsIGxvY2F0aW9uKSB7XG4gICAgICAgICAgICByZXR1cm4gYWxsX25hbWVzLmNvbmNhdChbbG9jYXRpb24ubmFtZSwgbG9jYXRpb24ubG9jYXRpb25fbmFtZSwgbG9jYXRpb24ubG9jYXRpb25fY2l0eV0pO1xuICAgICAgICB9LCBbXSlcbiAgICAgICAgLmZpbHRlcihmdW5jdGlvbihpdGVtKSB7XG4gICAgICAgICAgICBpZiAoIXBsYWNlX2hhc2hbaXRlbV0pIHtcbiAgICAgICAgICAgICAgICBwbGFjZV9oYXNoW2l0ZW1dID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgIGxvY2F0aW9uX25hbWVzLnNvcnQoKGEsIGIpID0+IGEubG9jYWxlQ29tcGFyZShiKSk7XG5cbiAgICByZXR1cm4gbG9jYXRpb25fbmFtZXM7XG59XG5cbmZ1bmN0aW9uIHByZWRpY3RTZWFyY2goc3RyKSB7XG4gICAgLy8gRmlsdGVyIGxpc3QgdG8gb25seSBpbmNsdWRlIHN0cmluZ3MgdGhhdCBoYXZlIGdpdmVuIHN0cmluZ1xuICAgIC8vIGFzIGEgc3Vic3RyaW5nXG4gICAgbGV0IGxpc3QgPSBhcHAubW9kZWwubG9jYXRpb25fbmFtZXMuZmlsdGVyKGZ1bmN0aW9uKHBsYWNlKSB7XG4gICAgICAgIC8vIFRoZXJlIGlzIHByb2JhYmx5IGEgYmV0dGVyIHdheSB0byBkbyB0aGlzIHdpdGggYSB0cmllXG4gICAgICAgIHJldHVybiBwbGFjZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHN0ci50b0xvd2VyQ2FzZSgpKTtcbiAgICB9KTtcblxuICAgIC8vIFVzZXIgbmV3IGxpc3QgdG8gZmlsbCBwcmVkaWN0aW9uIGJveCBcbiAgICAvLyB3aXRoIGdpdmVuIHNlbGVjdG9yXG4gICAgZmlsbFByZWRpY3RvckJveCgnLnByZWRpY3RpdmUtcmVzdWx0cycsIGxpc3QpO1xufVxuXG5mdW5jdGlvbiBmaWxsUHJlZGljdG9yQm94KHNlbGVjdG9yLCBsaXN0KSB7XG4gICAgLy8gVXNlIGxpc3QgdG8gZmlsbCBlbGVtZW50IHdpdGggbGlzdCBpdGVtc1xuXG4gICAgLy8gU2V0IHZhcmlhYmxlIGZvciBlbGVtZW50IHdpdGggc2VsZWN0b3JcbiAgICB2YXIgJHByZWRpY3RvciA9ICQoc2VsZWN0b3IpO1xuXG4gICAgLy8gQ2xlYXIgZWxlbWVudFxuICAgICRwcmVkaWN0b3IuaHRtbChcIlwiKTtcblxuICAgIC8vIEFkZCBmaXJzdCBpdGVtIGZvciBhbGwgcmVzdWx0c1xuICAgICRwcmVkaWN0b3IuYXBwZW5kKGBcbiAgICAgICAgICAgIDxsaSBkYXRhLWlkPVwiXCIgXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJwcmVkaWN0aXZlLWl0ZW1cIlxuICAgICAgICAgICAgICAgIGRhdGEtbmFtZT1cIkFsbFwiPlNlYXJjaCBhbGwgbG9jYXRpb25zLi48L2xpPmApO1xuXG4gICAgLy8gSXRlcmF0ZSB0aHJvdWdoIGxpc3QgY3JlYXRpbmcgYW5kIGFkZGluZyBpdGVtc1xuICAgIGZvciAobGV0IGxvY2F0aW9uIG9mIGxpc3QpIHtcbiAgICAgICAgJHByZWRpY3Rvci5hcHBlbmQoYFxuICAgICAgICAgICAgPGxpIGRhdGEtaWQ9XCJcIiBcbiAgICAgICAgICAgICAgICBjbGFzcz1cInByZWRpY3RpdmUtaXRlbVwiXG4gICAgICAgICAgICAgICAgZGF0YS1uYW1lPVwiJHtsb2NhdGlvbn1cIj4ke2xvY2F0aW9ufTwvbGk+YCk7XG4gICAgfVxuXG4gICAgLy8gU2V0IGhhbmRsZXIgb24gYWxsIG5ld2x5IGNyZWF0ZWQgZWxlbWVudHNcbiAgICAvLyBIYW5kbGVyIGNyZWF0ZXMgY2xpY2sgZXZlbnQgdG8gbW92ZSBzZWxlY3RlZCBpdGVtJ3MgZGF0YS1uYW1lXG4gICAgLy8gcHJvcGVydHkgdmFsdWUgaW50byBzZWFyY2ggYmFyIHRvIGxldCB1c2VyIG1hbnVhbGx5IGNvbnRpbnVlIHNlYXJjaC5cbiAgICAkKCcucHJlZGljdGl2ZS1pdGVtJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgICAgIGxldCBuYW1lID0gJCh0aGlzKS5kYXRhKCduYW1lJyk7XG5cbiAgICAgICAgLy8gSWYgdXNlciBzZWxlY3RzIFwiQWxsXCIsIGp1c3QgZ28gYWhlYWQgYW5kIHNlYXJjaCBhbGxcbiAgICAgICAgaWYgKG5hbWUgPT09IFwiQWxsXCIpIHtcbiAgICAgICAgICAgIHByb2Nlc3NTZWFyY2goKTtcbiAgICAgICAgICAgIC8vIFNjcm9sbCBkb3duIHRvIHJldmVhbCByZXN1bHRzXG4gICAgICAgICAgICBhcHAuY29tcG9uZW50cy5yZXN1bHRzX2FyZWEucmV2ZWFsUmVzdWx0c0FyZWEoKTtcbiAgICAgICAgICAgIC8vIE5vdyBkb25lLiBIaWRlIGJveFxuICAgICAgICAgICAgJCgnLnByZWRpY3RpdmUtYm94JykuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgLy8gUHV0IGRhdGEtbmFtZSBmcm9tIGl0ZW0gaW50byBpbnB1dCBmaWVsZFxuICAgICAgICAgICAgJCgnI2xvY2F0aW9uLXNlYXJjaC1mb3JtIGlucHV0W3R5cGU9XCJ0ZXh0XCJdJykudmFsKG5hbWUpO1xuICAgICAgICAgICAgLy8gTm93IGRvbmUuIEhpZGUgYm94XG4gICAgICAgICAgICAkKCcucHJlZGljdGl2ZS1ib3gnKS5oaWRlKCk7XG4gICAgICAgIH1cbiAgICB9KVxufVxuXG5mdW5jdGlvbiBwcm9jZXNzU2VhcmNoKHN0cikge1xuICAgIC8vIEZpcnN0IGNsZWFyIHJlc3VsdHMgYW5kIHNob3cgbG9hZGVyXG4gICAgJCgnLnJlc3VsdHMtbGlzdCcpLmh0bWwoXCJcIik7XG4gICAgLy8gU2hvdyBsb2FkZXIgd2hpbGUgd2Ugd2FpdCBmb3IgbmV3IHJlc3VsdHNcbiAgICAkKCcucmVzdWx0cy1zZWN0aW9uIC5sb2FkZXInKS5zaG93KCk7XG5cbiAgICAvLyBDbGVhciBpbnB1dCBmaWVsZFxuICAgICQoJyNsb2NhdGlvbi1zZWFyY2gtZm9ybSBpbnB1dFt0eXBlPVwidGV4dFwiXScpLnZhbChcIlwiKTtcbiAgICBcbiAgICAvLyBJbml0aWF0ZSBnZXQgYW5kIHNldCB1cCB3aGVuIGZvciBwcm9taXNlXG4gICAgJC53aGVuKGdldERhdGEoc3RyKSkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgIC8vIFByZXRlbmQgdG8gZ2V0IG5ldyBzZWFyY2ggcmVzdWx0cyB3aXRoIG5ldyBxdWVyeVxuICAgICAgICAvLyBhbmQgdXBkYXRlIG1vZGVsXG4gICAgICAgIGFwcC5tb2RlbC5yYXdfZGF0YSA9IGRhdGE7XG5cbiAgICAgICAgLy8gVGhpcyBsaW5lIGlzIG9ubHkgdG8gc2ltdWxhdGUgbmV3IHNlYXJjaCByZXN1bHRzXG4gICAgICAgIGFwcC5tb2RlbC5sb2NhdGlvbnMgPSBjcmVhdGVSZXN1bHRzTGlzdChzdHIpO1xuXG4gICAgICAgIC8vIFVwZGF0ZSByZXN1bHRzIGFuZCByZXNldCByZXNwb25zaXZlIGVsZW1lbnRzXG4gICAgICAgIGFwcC5jb21wb25lbnRzLnJlc3VsdHNfYXJlYS51cGRhdGUobG9jYXRpb25zKTsoYXBwLm1vZGVsLmxvY2F0aW9ucyk7XG4gICAgICAgIHNldERpbWVuc2lvbnNGb3JSZXNwb25zaXZlRWxlbWVudHMoKTtcblxuICAgICAgICAvLyBIaWRlIGxvYWRlciBhZnRlciBsb2FkaW5nIG5ldyByZXN1bHRzXG4gICAgICAgICQoJy5yZXN1bHRzLXNlY3Rpb24gLmxvYWRlcicpLmZhZGVPdXQoKTtcblxuICAgIH0pLmZhaWwoZnVuY3Rpb24oZXJyb3IpIHtcblxuICAgICAgICAvLyBTZXQgdXAgZmFpbCBmb3Igb2ZmbGluZSBkZXYgd29ya2Zsb3c6XG4gICAgICAgIC8vIE1vc3RseSB0aGUgc2FtZSBhcyBhYm92ZVxuICAgICAgICBjb25zb2xlLmVycm9yKFwiQ291bGQgbm90IGNvbm5lY3QgdG8gQVBJLlwiLFwiVXNpbmcgc2Vzc2lvbiBzdG9yYWdlLi5cIiwgZXJyb3IpO1xuICAgICAgICBhcHAubW9kZWwubG9jYXRpb25zID0gY3JlYXRlUmVzdWx0c0xpc3Qoc3RyKTtcbiAgICAgICAgLy8gVXBkYXRlIHJlc3VsdHMgYW5kIHJlc2V0IHJlc3BvbnNpdmUgZWxlbWVudHNcbiAgICAgICAgYXBwLmNvbXBvbmVudHMucmVzdWx0c19hcmVhLnVwZGF0ZShhcHAubW9kZWwubG9jYXRpb25zKTtcbiAgICAgICAgc2V0RGltZW5zaW9uc0ZvclJlc3BvbnNpdmVFbGVtZW50cygpO1xuICAgICAgICAvLyBIaWRlIGxvYWRlciBhZnRlciBsb2FkaW5nIG5ldyByZXN1bHRzXG4gICAgICAgICQoJy5yZXN1bHRzLXNlY3Rpb24gLmxvYWRlcicpLmZhZGVPdXQoKTtcbiAgICB9KTtcblxufSIsImZ1bmN0aW9uIHNldEV2ZW50SGFuZGxlcnMoKSB7XG4gICAgLy8gU2VhcmNoIGZvcm1cbiAgICAkKCcjbG9jYXRpb24tc2VhcmNoLWZvcm0nKS5zdWJtaXQoZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIC8vIEdldCBzZWFyY2ggcXVlcnkgZnJvbSBpbnB1dFxuICAgICAgICBsZXQgc2VhcmNoX2lucXVpcnkgPSAkKCdpbnB1dFt0eXBlPVwidGV4dFwiXScpLnZhbCgpO1xuICAgICAgICBpZihzZWFyY2hfaW5xdWlyeSkge1xuICAgICAgICAgICAgLy8gSWYgc2VhcmNoIHF1ZXJ5LCBwcm9jZXNzIG5ldyBzZWFyY2hcbiAgICAgICAgICAgIHByb2Nlc3NTZWFyY2goc2VhcmNoX2lucXVpcnkpO1xuICAgICAgICAgICAgLy8gQ2xlYXIgaW5wdXRcbiAgICAgICAgICAgICQoJ2lucHV0W3R5cGU9XCJ0ZXh0XCJdJykudmFsKFwiXCIpO1xuICAgICAgICAgICAgLy8gU2Nyb2xsIGRvd24gdG8gcmV2ZWFsIHNlYXJjaCBhcmVhXG4gICAgICAgICAgICBhcHAuY29tcG9uZW50cy5yZXN1bHRzX2FyZWEucmV2ZWFsUmVzdWx0c0FyZWEoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gU2VhcmNoIGZvcm0gcHJlZGljdGl2ZSBzZWFyY2hcbiAgICAkKCcjbG9jYXRpb24tc2VhcmNoLWZvcm0gaW5wdXRbdHlwZT1cInRleHRcIl0nKS5mb2N1cyhmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gV2hlbiBmb2N1cyBpcyBvbiBzZWFyY2ggaW5wdXRcbiAgICAgICAgLy8gRXZhbHVhdGUgc3RyaW5nIG9uIGtleXVwIC0ga2V5ZG93biBmaXJlcyBiZWZvcmUgdGV4dCBpcyBhdmFpbGFibGVcbiAgICAgICAgJCgnI2xvY2F0aW9uLXNlYXJjaC1mb3JtIGlucHV0W3R5cGU9XCJ0ZXh0XCJdJykua2V5dXAoZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgbGV0IHNlYXJjaF9pbnF1aXJ5ID0gJCgnI2xvY2F0aW9uLXNlYXJjaC1mb3JtIGlucHV0W3R5cGU9XCJ0ZXh0XCJdJykudmFsKCk7XG4gICAgICAgICAgICAvLyBJbml0aWF0ZSBwcmVkaWN0aXZlIHNlYXJjaCBwcm9jZXNzIHdpdGggY3VycmVudCBpbnB1dFxuICAgICAgICAgICAgcHJlZGljdFNlYXJjaChzZWFyY2hfaW5xdWlyeSk7XG4gICAgICAgICAgICAvLyBTaG93IHByZWRpY3Rpb25zXG4gICAgICAgICAgICAkKCcucHJlZGljdGl2ZS1ib3gnKS5zaG93KCk7XG4gICAgICAgICAgICBpZiAoZS5rZXlDb2RlID09IDI3KSB7XG4gICAgICAgICAgICAgICAgLy8gVXNlciBwcmVzc2VkIGVzYyBrZXlcbiAgICAgICAgICAgICAgICAvLyBIaWRlIGJveCBhbmQgY2xlYXIgaW5wdXQgZmllbGRcbiAgICAgICAgICAgICAgICAkKCcucHJlZGljdGl2ZS1ib3gnKS5oaWRlKCk7XG4gICAgICAgICAgICAgICAgJCgnI2xvY2F0aW9uLXNlYXJjaC1mb3JtIGlucHV0W3R5cGU9XCJ0ZXh0XCJdJykudmFsKFwiXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH0pO1xuXG4gICAgLy8gSGlkZSBwcmVkaWN0aW9uIGJveCB3aGVuIGZvY3VzIGlzbid0IG9uIHNlYXJjaFxuICAgIC8vIEFORCBjdXJzb3IgaXNuJ3Qgb3ZlciB0aGUgYm94XG4gICAgJCgnI2xvY2F0aW9uLXNlYXJjaC1mb3JtIGlucHV0W3R5cGU9XCJ0ZXh0XCJdJykuZm9jdXNvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICghJCgnLnByZWRpY3RpdmUtYm94JykuaXMoXCI6aG92ZXJcIikpIHtcbiAgICAgICAgICAgICQoJy5wcmVkaWN0aXZlLWJveCcpLmhpZGUoKTtcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gRmlsbCBzZWFyY2ggYmFyIHdpdGggd2hhdGV2ZXIgYSB1c2VyIHNlbGVjdHMgZnJvbSBsaXN0XG4gICAgJCgnLnByZWRpY3RpdmUtaXRlbScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBDbGVhciBmaXJzdFxuICAgICAgICAkKCcucHJlZGljdGl2ZS1yZXN1bHRzJykuaHRtbChcIlwiKTtcbiAgICAgICAgLy8gR2V0IG5hbWUgZnJvbSBpdGVtIGNsaWNrZWRcbiAgICAgICAgJCh0aGlzKS5kYXRhKCduYW1lJyk7XG4gICAgICAgIC8vIEhpZGUgYm94XG4gICAgICAgICQoJy5wcmVkaWN0aXZlLWJveCcpLmhpZGUoKTtcbiAgICB9KVxufSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
