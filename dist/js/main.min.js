"use strict";function getData(e){return $.ajax({dataType:"json",url:"https://www.deskbookers.com/nl-nl/sajax.json?q=Amsterdam&type=-&people=any&favorite=0&pid=&sw=52.293753%2C4.634942&ne=52.455562%2C5.162286&ids=17201%2C19640%2C13692%2C13691%2C12136%2C17938%2C15292%2C14886%2C14885%2C14884%2C14883%2C15730%2C15353%2C15351%2C15330%2C15080%2C17290%2C15454%2C15451%2C15379"})}function setDimensionsForResponsiveElements(){$("ul.results-list").css("width",$(".result-item").width()*$(".result-item").length+"px")}function createCarousel(e,t){function a(){var e='\n            <div class="control-wrapper left">\n                <div class="control left-control">\n                    <i class="fa fa-chevron-left" aria-hidden="true"></i>\n                </div>\n            </div>\n            <div class="control-wrapper right">\n                <div class="control right-control">\n                    <i class="fa fa-chevron-right" aria-hidden="true"></i>\n                </div>\n            </div>\n        ';n.append(e),n.find(".right-control").on("click",function(){n.nextImage()}),n.find(".left-control").on("click",function(){n.prevImage()})}var n=$(e);return n.current_image_index=0,n.images=t,n.goToImage=function(e){$(".carousel-item").fadeOut(2e3),$('.carousel-item[data-id="'+e+'"]').fadeIn(2e3),0===n.images.length?n.find(".control").hide():n.find(".control").show()},n.updateSlides=function(e,t){n.images=e,n.find("ul").html(""),e.forEach(function(e,a){"string"==typeof e&&n.find("ul").append('<li \n                    id="image-'+a+'" \n                    data-id="'+a+'" \n                    class="carousel-item" \n                    style="background-image:url(\''+e+'\')">\n                        <h1 class="headline">'+(t[a]||"Headline #"+(a+1))+"</h1>\n                    </li>\n                ")}),n.goToImage(0)},n.nextImage=function(){n.images[n.current_image_index+1]?n.goToImage(++n.current_image_index):(n.goToImage(0),n.current_image_index=0)},n.prevImage=function(){n.images[n.current_image_index-1]?n.goToImage(--n.current_image_index):(n.goToImage(n.images.length-1),n.current_image_index=n.images.length-1)},a(),n.append("<ul></ul>"),n.updateSlides(t,["Fast, Easy, Flexible","Book one of our spaces"]),setInterval(function(){n.is(":hover")||n.nextImage()},6e3),n}function updateResults(e){console.log("Update Results",e),e.map(function(e,t){var a=e.url,n=e.name,o=e.location_name,i=e.rating||"-",r=e.day_price?"€"+e.day_price+"/day":"",s=e.hour_price?"€"+e.hour_price+"/hour":"",l=e.image_urls2[0];$(".results-list").append('<li \n            id="location-'+t+'" \n            class="result-item" \n            style="background-image:url(\''+l+'\'); display: none;">\n                <a href="'+(a||"#")+'">\n                    <ul class="location-info">\n                        <li class="first-line">'+n+"</li>\n                        <li>"+o+"</li>\n                        <li>Score: "+i+"</li>\n                        <li>"+r+"</li>\n                        <li>"+s+"</li>\n                    </ul>\n                </a>\n            </li>"),$("#location-"+t).fadeIn(1e3*t)})}function revealResultsArea(){$("html, body").animate({scrollTop:$(".results-section").height()},1e3)}function createResultsArea(){return{update:updateResults,revealResultsArea:revealResultsArea}}function createResultsList(e){var t=app.model.raw_data.rows;if(!e)return t;var a=t.filter(function(t){return t.name===e||t.location_name===e||t.location_city===e});return a}function createSearchList(e){var t={},a=e.reduce(function(e,t){return e.concat([t.name,t.location_name,t.location_city])},[]).filter(function(e){return!t[e]&&(t[e]=!0,!0)});return a.sort(function(e,t){return e.localeCompare(t)}),a}function predictSearch(e){var t=app.model.location_names.filter(function(t){return t.toLowerCase().includes(e.toLowerCase())});fillPredictorBox(".predictive-results",t)}function fillPredictorBox(e,t){var a=$(e);a.html(""),a.append('\n            <li data-id="" \n                class="predictive-item"\n                data-name="All">Search all locations..</li>');var n=!0,o=!1,i=void 0;try{for(var r,s=t[Symbol.iterator]();!(n=(r=s.next()).done);n=!0){var l=r.value;a.append('\n            <li data-id="" \n                class="predictive-item"\n                data-name="'+l+'">'+l+"</li>")}}catch(c){o=!0,i=c}finally{try{!n&&s["return"]&&s["return"]()}finally{if(o)throw i}}$(".predictive-item").on("click",function(){var e=$(this).data("name");"All"===e?(processSearch(),app.components.results_area.revealResultsArea(),$(".predictive-box").hide()):($('#location-search-form input[type="text"]').val(e),$(".predictive-box").hide())})}function processSearch(e){$(".results-list").html(""),$(".results-section .loader").show(),$('#location-search-form input[type="text"]').val(""),$.when(getData(e)).then(function(t){app.model.raw_data=t,app.model.locations=createResultsList(e),app.components.results_area.update(locations),app.model.locations,setDimensionsForResponsiveElements(),$(".results-section .loader").fadeOut()}).fail(function(t){console.error("Could not connect to API.","Using session storage..",t),app.model.locations=createResultsList(e),app.components.results_area.update(app.model.locations),setDimensionsForResponsiveElements(),$(".results-section .loader").fadeOut()})}function setEventHandlers(){$("#location-search-form").submit(function(e){e.preventDefault();var t=$('input[type="text"]').val();t&&(processSearch(t),$('input[type="text"]').val(""),app.components.results_area.revealResultsArea())}),$('#location-search-form input[type="text"]').focus(function(){$('#location-search-form input[type="text"]').keyup(function(e){var t=$('#location-search-form input[type="text"]').val();predictSearch(t),$(".predictive-box").show(),27==e.keyCode&&($(".predictive-box").hide(),$('#location-search-form input[type="text"]').val(""))})}),$('#location-search-form input[type="text"]').focusout(function(){$(".predictive-box").is(":hover")||$(".predictive-box").hide()}),$(".predictive-item").on("click",function(){$(".predictive-results").html(""),$(this).data("name"),$(".predictive-box").hide()})}var max_results=20,app={model:{raw_data:void 0,locations:void 0,location_names:void 0},components:{main_carousel:void 0,results_area:{update:void 0,revealResultsArea:void 0}},init:function(){if(sessionStorage.getItem("location_data")){var e=sessionStorage.getItem("location_data");app.model.raw_data=JSON.parse(e),console.log("Using data from session storage..",app.model.raw_data),app.setUp()}else $(".loader").show(),app.setData()},setData:function(){$.when(getData()).then(function(e){console.log("Retrieved data",e),sessionStorage.setItem("location_data",JSON.stringify(e)),app.model.raw_data=e,app.setUp(),$(".loader").fadeOut()})},setUp:function(){app.model.locations=app.model.raw_data.rows;var e=app.model.locations.slice(0,Math.min(max_results,app.model.locations.length-1)),t=app.model.locations.reduce(function(e,t){return e.concat(t.image_urls)},[]);$(document).ready(function(){app.model.location_names=createSearchList(app.model.raw_data.rows),app.components.main_carousel=createCarousel("carousel",t),app.components.results_area=createResultsArea(),app.components.results_area.update(e),$(".search-box").show(),setEventHandlers(),setDimensionsForResponsiveElements()})}};app.init(),$(window).resize(function(){setDimensionsForResponsiveElements()});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2UuanMiLCJjcmVhdGVDYXJvdXNlbC5qcyIsImNyZWF0ZVJlc3VsdHNBcmVhLmpzIiwic2VhcmNoX2Z1bmN0aW9ucy5qcyIsInNldEV2ZW50SGFuZGxlcnMuanMiXSwibmFtZXMiOlsiZ2V0RGF0YSIsInNlYXJjaF9pbnF1aXJ5IiwiJCIsImFqYXgiLCJkYXRhVHlwZSIsInVybCIsInNldERpbWVuc2lvbnNGb3JSZXNwb25zaXZlRWxlbWVudHMiLCJjc3MiLCJ3aWR0aCIsImxlbmd0aCIsImNyZWF0ZUNhcm91c2VsIiwiZWxlbWVudCIsImltYWdlX2FyciIsImNyZWF0ZUNvbnRyb2xzIiwidGVtcGxhdGUiLCIkY2Fyb3VzZWwiLCJhcHBlbmQiLCJmaW5kIiwib24iLCJuZXh0SW1hZ2UiLCJwcmV2SW1hZ2UiLCJjdXJyZW50X2ltYWdlX2luZGV4IiwiaW1hZ2VzIiwiZ29Ub0ltYWdlIiwiaW5kZXgiLCJmYWRlT3V0IiwiZmFkZUluIiwiaGlkZSIsInNob3ciLCJ1cGRhdGVTbGlkZXMiLCJzbGlkZXMiLCJoZWFkbGluZXMiLCJodG1sIiwiZm9yRWFjaCIsInNldEludGVydmFsIiwiaXMiLCJ1cGRhdGVSZXN1bHRzIiwibG9jYXRpb25zIiwiY29uc29sZSIsImxvZyIsIm1hcCIsImxvY2F0aW9uIiwibG9jYXRpb25fdXJsIiwid29ya3BsYWNlIiwibmFtZSIsImxvY2F0aW9uX25hbWUiLCJyZXZpZXdfc2NvcmUiLCJyYXRpbmciLCJkYXlfcHJpY2UiLCJob3VyX3ByaWNlIiwiaW1hZ2VfdXJsIiwiaW1hZ2VfdXJsczIiLCJyZXZlYWxSZXN1bHRzQXJlYSIsImFuaW1hdGUiLCJzY3JvbGxUb3AiLCJoZWlnaHQiLCJjcmVhdGVSZXN1bHRzQXJlYSIsInVwZGF0ZSIsImNyZWF0ZVJlc3VsdHNMaXN0Iiwic3RyIiwiYXBwIiwibW9kZWwiLCJyYXdfZGF0YSIsInJvd3MiLCJyZXN1bHRzIiwiZmlsdGVyIiwibG9jYXRpb25fY2l0eSIsImNyZWF0ZVNlYXJjaExpc3QiLCJwbGFjZV9oYXNoIiwibG9jYXRpb25fbmFtZXMiLCJyZWR1Y2UiLCJhbGxfbmFtZXMiLCJjb25jYXQiLCJpdGVtIiwic29ydCIsImEiLCJiIiwibG9jYWxlQ29tcGFyZSIsInByZWRpY3RTZWFyY2giLCJsaXN0IiwicGxhY2UiLCJ0b0xvd2VyQ2FzZSIsImluY2x1ZGVzIiwiZmlsbFByZWRpY3RvckJveCIsInNlbGVjdG9yIiwiJHByZWRpY3RvciIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwidW5kZWZpbmVkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwidmFsdWUiLCJlcnIiLCJ0aGlzIiwiZGF0YSIsInByb2Nlc3NTZWFyY2giLCJjb21wb25lbnRzIiwicmVzdWx0c19hcmVhIiwidmFsIiwid2hlbiIsInRoZW4iLCJmYWlsIiwiZXJyb3IiLCJzZXRFdmVudEhhbmRsZXJzIiwic3VibWl0IiwiZSIsInByZXZlbnREZWZhdWx0IiwiZm9jdXMiLCJrZXl1cCIsImtleUNvZGUiLCJmb2N1c291dCIsIm1heF9yZXN1bHRzIiwibWFpbl9jYXJvdXNlbCIsImluaXQiLCJzZXNzaW9uU3RvcmFnZSIsImdldEl0ZW0iLCJkYXRhU3RyaW5nIiwiSlNPTiIsInBhcnNlIiwic2V0VXAiLCJzZXREYXRhIiwic2V0SXRlbSIsInN0cmluZ2lmeSIsInNsaWNlIiwiTWF0aCIsIm1pbiIsIm1haW5faW1hZ2VzIiwiYWxsX2ltYWdlcyIsImltYWdlX3VybHMiLCJkb2N1bWVudCIsInJlYWR5Iiwid2luZG93IiwicmVzaXplIl0sIm1hcHBpbmdzIjoiQUFBQSxZQUlBLFNBQVNBLFNBQVFDLEdBR2IsTUFBT0MsR0FBRUMsTUFDTEMsU0FBVSxPQUNWQyxJQUFLLGlUQUliLFFBQVNDLHNDQUlMSixFQUFFLG1CQUFtQkssSUFBSSxRQUFTTCxFQUFFLGdCQUFnQk0sUUFBVU4sRUFBRSxnQkFB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QU8sU0FBUzhELEVBQVkzRixHQUM5RCxNQUFPMkYsR0FBVzVELE9BQU8vQixFQUFTNEYsZ0JBSXRDbkksR0FBRW9JLFVBQVVDLE1BQU0sV0FDZDNFLElBQUlDLE1BQU1RLGVBQWlCRixpQkFBaUJQLElBQUlDLE1BQU1DLFNBQVNDLE1BQy9ESCxJQUFJeUMsV0FBV2dCLGNBQWdCM0csZUFBZSxXQUFZeUgsR0FDMUR2RSxJQUFJeUMsV0FBV0MsYUFBZTlDLG9CQUM5QkksSUFBSXlDLFdBQVdDLGFBQWE3QyxPQUFPcEIsR0FDbkNuQyxFQUFFLGVBQWUwQixPQUNqQmdGLG1CQUNBdEcsd0NBTVpzRCxLQUFJMEQsT0FDSnBILEVBQUVzSSxRQUFRQyxPQUFPLFdBQ2JuSSIsImZpbGUiOiJtYWluLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgbWF4X3Jlc3VsdHMgPSAyMDsgLy9Vc2UgdGhpcyBudW1iZXIgdG8gY2FwIHRoZSBhbW91bnQgb2YgZGF0YSBiZWluZyByZXF1ZXN0ZWQgZnJvbSBBUElcblxuZnVuY3Rpb24gZ2V0RGF0YShzZWFyY2hfaW5xdWlyeSkge1xuICAgIC8vIFNlYXJjaCBpbnF1aXJ5IHdvdWxkIGJlIHVzZWQgdG8gZ2V0IHNwZWNpZmljIHJlc3VsdHMgZnJvbSBBUElcbiAgICAvLyBGb3IgdGhpcyBjaGFsbGVuZ2UsIG9ubHkgdXNpbmcgc3BlY2lmaWVkIHF1ZXJ5IHN0cmluZyBiZWxvdzpcbiAgICByZXR1cm4gJC5hamF4KHtcbiAgICAgICAgZGF0YVR5cGU6IFwianNvblwiLFxuICAgICAgICB1cmw6ICdodHRwczovL3d3dy5kZXNrYm9va2Vycy5jb20vbmwtbmwvc2FqYXguanNvbj9xPUFtc3RlcmRhbSZ0eXBlPS0mcGVvcGxlPWFueSZmYXZvcml0ZT0wJnBpZD0mc3c9NTIuMjkzNzUzJTJDNC42MzQ5NDImbmU9NTIuNDU1NTYyJTJDNS4xNjIyODYmaWRzPTE3MjAxJTJDMTk2NDAlMkMxMzY5MiUyQzEzNjkxJTJDMTIxMzYlMkMxNzkzOCUyQzE1MjkyJTJDMTQ4ODYlMkMxNDg4NSUyQzE0ODg0JTJDMTQ4ODMlMkMxNTczMCUyQzE1MzUzJTJDMTUzNTElMkMxNTMzMCUyQzE1MDgwJTJDMTcyOTAlMkMxNTQ1NCUyQzE1NDUxJTJDMTUzNzknXG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIHNldERpbWVuc2lvbnNGb3JSZXNwb25zaXZlRWxlbWVudHMoKSB7XG4gICAgLy8gU2V0IHdpZHRoIG9mIHJlc3VsdHMgbGlzdCBieSBmaWd1cmluZyBvdXQgMS81IG9mIHdpbmRvdyB3aWR0aCBcbiAgICAvLyB0aGVuIG11bHRpcGx5aW5nIHRoYXQgYnkgdGhlIG51bWJlciBvZiBpdGVtc1xuICAgIC8vIEdpdmVzXG4gICAgJCgndWwucmVzdWx0cy1saXN0JykuY3NzKCd3aWR0aCcsICQoJy5yZXN1bHQtaXRlbScpLndpZHRoKCkgKiAkKCcucmVzdWx0LWl0ZW0nKS5sZW5ndGggKyAncHgnKTtcbn1cblxudmFyIGFwcCA9IHtcbiAgICAvLyBJbml0aWFsaXplIHRoZSBhcHBcbiAgICAvLyBUaGlzIGxheXMgb3V0IHRoZSBzdHJ1Y3R1cmUgYXMgYSByZWZlcmVuY2VcbiAgICBtb2RlbDoge1xuICAgICAgICByYXdfZGF0YTogdW5kZWZpbmVkLCAvL0FsbCBkYXRhIGZyb20gc2VydmVyXG4gICAgICAgIGxvY2F0aW9uczogdW5kZWZpbmVkLCAvL0N1cnJlbnQgcmVzdWx0IGRhdGFcbiAgICAgICAgbG9jYXRpb25fbmFtZXM6IHVuZGVmaW5lZCAvL1Bvc3NpYmxlIHNlYXJjaCByZXN1bHRzXG4gICAgfSxcbiAgICBjb21wb25lbnRzOiB7XG4gICAgICAgIG1haW5fY2Fyb3VzZWw6IHVuZGVmaW5lZCwgLy8gXG4gICAgICAgIHJlc3VsdHNfYXJlYToge1xuICAgICAgICAgICAgdXBkYXRlOiB1bmRlZmluZWQsIC8vIFVwZGF0ZSByZXN1bHRzIGFyZWFcbiAgICAgICAgICAgIHJldmVhbFJlc3VsdHNBcmVhOiB1bmRlZmluZWQgLy8gU2Nyb2xsIGRvd24gdG8gcmV2ZWFsIHJlc3VsdHNcbiAgICAgICAgfVxuICAgIH0sXG4gICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFVzZSBzZXNzaW9uIHN0b3JhZ2UgaWYgYXZhaWxhYmxlXG4gICAgICAgIGlmIChzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdsb2NhdGlvbl9kYXRhJykpIHtcbiAgICAgICAgICAgIC8vIEdldCBkYXRhIGZyb20gc2Vzc2lvbiBzdG9yYWdlIGFzIHN0cmluZ1xuICAgICAgICAgICAgbGV0IGRhdGFTdHJpbmcgPSBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdsb2NhdGlvbl9kYXRhJyk7XG4gICAgICAgICAgICAvLyBQYXJzZSB0byBKU09OIGZvciB1c2UgaW4gYXBwXG4gICAgICAgICAgICBhcHAubW9kZWwucmF3X2RhdGEgPSBKU09OLnBhcnNlKGRhdGFTdHJpbmcpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ1VzaW5nIGRhdGEgZnJvbSBzZXNzaW9uIHN0b3JhZ2UuLicsIGFwcC5tb2RlbC5yYXdfZGF0YSk7XG4gICAgICAgICAgICAvLyBOb3cgdGhhdCBkYXRhIGlzIHNldCwgc2V0IHVwXG4gICAgICAgICAgICBhcHAuc2V0VXAoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFNob3cgbG9hZGVyIHdoaWxlIHdhaXRpbmcgZm9yIGFwaVxuICAgICAgICAgICAgJCgnLmxvYWRlcicpLnNob3coKTtcbiAgICAgICAgICAgIGFwcC5zZXREYXRhKCk7XG4gICAgICAgICAgICBcbiAgICAgICAgfVxuICAgIH0sXG4gICAgLy8gR2V0IGFuZCBzZXQgZGF0YSBmcm9tIHRoZSBBUElcbiAgICBzZXREYXRhOiBmdW5jdGlvbigpIHtcbiAgICAgICAgJC53aGVuKGdldERhdGEoKSkudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUmV0cmlldmVkIGRhdGEnLCBkYXRhKTtcbiAgICAgICAgICAgIC8vIFN0b3JlIGRhdGEgaW50byBzZXNzaW9ucyBzdG9yYWdlXG4gICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5zZXRJdGVtKCdsb2NhdGlvbl9kYXRhJywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpO1xuICAgICAgICAgICAgYXBwLm1vZGVsLnJhd19kYXRhID0gZGF0YTtcbiAgICAgICAgICAgIGFwcC5zZXRVcCgpO1xuICAgICAgICAgICAgLy8gT25jZSBldmVyeXRoaW5nIGlzIGxvYWRlZCwgZmFkZSBsb2FkZXJcbiAgICAgICAgICAgICQoJy5sb2FkZXInKS5mYWRlT3V0KCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgLy8gU2V0IHVwIHZpZXdzXG4gICAgc2V0VXA6IGZ1bmN0aW9uKCkge1xuICAgICAgICAvLyBTZXQgcmVzdWx0IGRhdGEgZnJvbSBhbGwgZGF0YVxuICAgICAgICBhcHAubW9kZWwubG9jYXRpb25zID0gYXBwLm1vZGVsLnJhd19kYXRhLnJvd3M7XG4gICAgICAgIHZhciBsb2NhdGlvbnMgPSBhcHAubW9kZWwubG9jYXRpb25zLnNsaWNlKDAsIE1hdGgubWluKG1heF9yZXN1bHRzLCBhcHAubW9kZWwubG9jYXRpb25zLmxlbmd0aCAtIDEpKTtcblxuICAgICAgICAvLyBUaGlzIHdhcyBpbml0aWFsbHkgc2V0IHVwIHRvIGp1c3QgaGF2ZSBhIGNhcm91c2VsIGZvciBvbmUgbG9jYXRpb25cbiAgICAgICAgLy8gdmFyIG1haW5faW1hZ2VzID0gbG9jYXRpb25zWzBdLmltYWdlX3VybHMuY29uY2F0KGxvY2F0aW9uc1swXS5pbWFnZV91cmxzMik7XG5cbiAgICAgICAgdmFyIG1haW5faW1hZ2VzID0gYXBwLm1vZGVsLmxvY2F0aW9ucy5yZWR1Y2UoZnVuY3Rpb24oYWxsX2ltYWdlcywgbG9jYXRpb24pIHtcbiAgICAgICAgICAgIHJldHVybiBhbGxfaW1hZ2VzLmNvbmNhdChsb2NhdGlvbi5pbWFnZV91cmxzKTtcbiAgICAgICAgfSwgW10pO1xuXG4gICAgICAgIC8vIFdhaXQgZm9yIHRoZSBkb2N1bWV0IHJlYWR5IGJlZm9yZSBidWlsZGluZyB2aWV3c1xuICAgICAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGFwcC5tb2RlbC5sb2NhdGlvbl9uYW1lcyA9IGNyZWF0ZVNlYXJjaExpc3QoYXBwLm1vZGVsLnJhd19kYXRhLnJvd3MpO1xuICAgICAgICAgICAgYXBwLmNvbXBvbmVudHMubWFpbl9jYXJvdXNlbCA9IGNyZWF0ZUNhcm91c2VsKCdjYXJvdXNlbCcsIG1haW5faW1hZ2VzKTtcbiAgICAgICAgICAgIGFwcC5jb21wb25lbnRzLnJlc3VsdHNfYXJlYSA9IGNyZWF0ZVJlc3VsdHNBcmVhKCk7XG4gICAgICAgICAgICBhcHAuY29tcG9uZW50cy5yZXN1bHRzX2FyZWEudXBkYXRlKGxvY2F0aW9ucyk7XG4gICAgICAgICAgICAkKCcuc2VhcmNoLWJveCcpLnNob3coKTtcbiAgICAgICAgICAgIHNldEV2ZW50SGFuZGxlcnMoKTtcbiAgICAgICAgICAgIHNldERpbWVuc2lvbnNGb3JSZXNwb25zaXZlRWxlbWVudHMoKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyBTdGFydCBwcm9jZXNzXG5hcHAuaW5pdCgpO1xuJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbigpIHtcbiAgICBzZXREaW1lbnNpb25zRm9yUmVzcG9uc2l2ZUVsZW1lbnRzKCk7XG59KVxuIiwiZnVuY3Rpb24gY3JlYXRlQ2Fyb3VzZWwoZWxlbWVudCwgaW1hZ2VfYXJyKSB7XG5cbiAgICB2YXIgJGNhcm91c2VsID0gJChlbGVtZW50KTtcbiAgICAkY2Fyb3VzZWwuY3VycmVudF9pbWFnZV9pbmRleCA9IDA7IC8vIFxuICAgICRjYXJvdXNlbC5pbWFnZXMgPSBpbWFnZV9hcnI7XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVDb250cm9scygpIHtcbiAgICAgICAgdmFyIHRlbXBsYXRlID0gYFxuICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRyb2wtd3JhcHBlciBsZWZ0XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRyb2wgbGVmdC1jb250cm9sXCI+XG4gICAgICAgICAgICAgICAgICAgIDxpIGNsYXNzPVwiZmEgZmEtY2hldnJvbi1sZWZ0XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9pPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY29udHJvbC13cmFwcGVyIHJpZ2h0XCI+XG4gICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImNvbnRyb2wgcmlnaHQtY29udHJvbFwiPlxuICAgICAgICAgICAgICAgICAgICA8aSBjbGFzcz1cImZhIGZhLWNoZXZyb24tcmlnaHRcIiBhcmlhLWhpZGRlbj1cInRydWVcIj48L2k+XG4gICAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgYDtcblxuICAgICAgICAkY2Fyb3VzZWwuYXBwZW5kKHRlbXBsYXRlKTtcblxuICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLnJpZ2h0LWNvbnRyb2wnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRjYXJvdXNlbC5uZXh0SW1hZ2UoKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGNhcm91c2VsLmZpbmQoJy5sZWZ0LWNvbnRyb2wnKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICRjYXJvdXNlbC5wcmV2SW1hZ2UoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgJGNhcm91c2VsLmdvVG9JbWFnZSA9IGZ1bmN0aW9uKGluZGV4KSB7XG4gICAgICAgICQoJy5jYXJvdXNlbC1pdGVtJykuZmFkZU91dCgyMDAwKTtcbiAgICAgICAgJChgLmNhcm91c2VsLWl0ZW1bZGF0YS1pZD1cIiR7aW5kZXh9XCJdYCkuZmFkZUluKDIwMDApO1xuXG4gICAgICAgIGlmICgkY2Fyb3VzZWwuaW1hZ2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgJGNhcm91c2VsLmZpbmQoJy5jb250cm9sJykuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICAgIC8qXG4gICAgICAgIC8vIFVubmVjZXNzYXJ5IHdpdGggbmV3IGxvb3BpbmcgZmVhdHVyZVxuICAgICAgICBlbHNlIGlmICgkY2Fyb3VzZWwuY3VycmVudF9pbWFnZV9pbmRleCA9PT0gMCkge1xuICAgICAgICAgICAgJGNhcm91c2VsLmZpbmQoJy5sZWZ0LWNvbnRyb2wnKS5oaWRlKCk7XG4gICAgICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLnJpZ2h0LWNvbnRyb2wnKS5zaG93KCk7XG4gICAgICAgIH0gZWxzZSBpZiAoJGNhcm91c2VsLmN1cnJlbnRfaW1hZ2VfaW5kZXggPT09ICRjYXJvdXNlbC5pbWFnZXMubGVuZ3RoIC0gMSkge1xuICAgICAgICAgICAgJGNhcm91c2VsLmZpbmQoJy5sZWZ0LWNvbnRyb2wnKS5zaG93KCk7XG4gICAgICAgICAgICAkY2Fyb3VzZWwuZmluZCgnLnJpZ2h0LWNvbnRyb2wnKS5oaWRlKCk7XG4gICAgICAgIH0gXG4gICAgICAgICovXG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgJGNhcm91c2VsLmZpbmQoJy5jb250cm9sJykuc2hvdygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgJGNhcm91c2VsLnVwZGF0ZVNsaWRlcyA9IGZ1bmN0aW9uKHNsaWRlcywgaGVhZGxpbmVzKSB7XG4gICAgICAgICRjYXJvdXNlbC5pbWFnZXMgPSBzbGlkZXM7XG4gICAgICAgICRjYXJvdXNlbC5maW5kKCd1bCcpLmh0bWwoXCJcIik7XG4gICAgICAgIHNsaWRlcy5mb3JFYWNoKGZ1bmN0aW9uKHVybCwgaW5kZXgpIHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgdXJsID09PSAnc3RyaW5nJykgeyAvLyBUeXBlIGNoZWNrXG4gICAgICAgICAgICAgICAgJGNhcm91c2VsLmZpbmQoJ3VsJykuYXBwZW5kKGA8bGkgXG4gICAgICAgICAgICAgICAgICAgIGlkPVwiaW1hZ2UtJHtpbmRleH1cIiBcbiAgICAgICAgICAgICAgICAgICAgZGF0YS1pZD1cIiR7aW5kZXh9XCIgXG4gICAgICAgICAgICAgICAgICAgIGNsYXNzPVwiY2Fyb3VzZWwtaXRlbVwiIFxuICAgICAgICAgICAgICAgICAgICBzdHlsZT1cImJhY2tncm91bmQtaW1hZ2U6dXJsKCcke3VybH0nKVwiPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGgxIGNsYXNzPVwiaGVhZGxpbmVcIj4ke2hlYWRsaW5lc1tpbmRleF0gfHwgXCJIZWFkbGluZSAjXCIgKyAoaW5kZXgrMSl9PC9oMT5cbiAgICAgICAgICAgICAgICAgICAgPC9saT5cbiAgICAgICAgICAgICAgICBgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJGNhcm91c2VsLmdvVG9JbWFnZSgwKTtcbiAgICB9XG5cbiAgICAkY2Fyb3VzZWwubmV4dEltYWdlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICgkY2Fyb3VzZWwuaW1hZ2VzWyRjYXJvdXNlbC5jdXJyZW50X2ltYWdlX2luZGV4ICsgMV0pIHtcbiAgICAgICAgICAgICRjYXJvdXNlbC5nb1RvSW1hZ2UoKyskY2Fyb3VzZWwuY3VycmVudF9pbWFnZV9pbmRleCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBMb29wXG4gICAgICAgICAgICAkY2Fyb3VzZWwuZ29Ub0ltYWdlKDApO1xuICAgICAgICAgICAgJGNhcm91c2VsLmN1cnJlbnRfaW1hZ2VfaW5kZXggPSAwO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgJGNhcm91c2VsLnByZXZJbWFnZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJGNhcm91c2VsLmltYWdlc1skY2Fyb3VzZWwuY3VycmVudF9pbWFnZV9pbmRleCAtIDFdKSB7XG4gICAgICAgICAgICAkY2Fyb3VzZWwuZ29Ub0ltYWdlKC0tJGNhcm91c2VsLmN1cnJlbnRfaW1hZ2VfaW5kZXgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gTG9vcFxuICAgICAgICAgICAgJGNhcm91c2VsLmdvVG9JbWFnZSgkY2Fyb3VzZWwuaW1hZ2VzLmxlbmd0aCAtIDEpO1xuICAgICAgICAgICAgJGNhcm91c2VsLmN1cnJlbnRfaW1hZ2VfaW5kZXggPSAkY2Fyb3VzZWwuaW1hZ2VzLmxlbmd0aCAtIDE7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjcmVhdGVDb250cm9scygpO1xuICAgICRjYXJvdXNlbC5hcHBlbmQoJzx1bD48L3VsPicpO1xuICAgICRjYXJvdXNlbC51cGRhdGVTbGlkZXMoaW1hZ2VfYXJyLCBbXCJGYXN0LCBFYXN5LCBGbGV4aWJsZVwiLCBcIkJvb2sgb25lIG9mIG91ciBzcGFjZXNcIl0pO1xuICAgIHNldEludGVydmFsKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoISRjYXJvdXNlbC5pcyhcIjpob3ZlclwiKSkge1xuICAgICAgICAgICAgJGNhcm91c2VsLm5leHRJbWFnZSgpO1xuICAgICAgICB9XG4gICAgfSwgNjAwMCk7XG4gICAgcmV0dXJuICRjYXJvdXNlbDtcbn0iLCJmdW5jdGlvbiB1cGRhdGVSZXN1bHRzKGxvY2F0aW9ucykge1xuICAgIC8vIEZpbGwgcmVzdWx0cyBkaXZcbiAgICBjb25zb2xlLmxvZygnVXBkYXRlIFJlc3VsdHMnLCBsb2NhdGlvbnMpO1xuXG4gICAgLy8gSXRlcmF0ZSB0aHJvdWdoIHJldHVybmVkIHJlc3VsdHMgYW5kIHVzZSBsaXN0IHRvIFxuICAgIC8vIHBvcHVsYXRlIHJlc3VsdHMgc2VjdGlvblxuICAgIGxvY2F0aW9ucy5tYXAoZnVuY3Rpb24obG9jYXRpb24sIGluZGV4KSB7XG4gICAgICAgIGxldCBsb2NhdGlvbl91cmwgPSBsb2NhdGlvbi51cmw7XG4gICAgICAgIGxldCB3b3JrcGxhY2UgPSBsb2NhdGlvbi5uYW1lO1xuICAgICAgICBsZXQgbG9jYXRpb25fbmFtZSA9IGxvY2F0aW9uLmxvY2F0aW9uX25hbWU7XG4gICAgICAgIGxldCByZXZpZXdfc2NvcmUgPSBsb2NhdGlvbi5yYXRpbmcgfHwgXCItXCI7XG4gICAgICAgIGxldCBkYXlfcHJpY2UgPSAobG9jYXRpb24uZGF5X3ByaWNlKSA/ICfigqwnICsgbG9jYXRpb24uZGF5X3ByaWNlICsgXCIvZGF5XCIgOiBcIlwiO1xuICAgICAgICBsZXQgaG91cl9wcmljZSA9IChsb2NhdGlvbi5ob3VyX3ByaWNlKSA/ICfigqwnICsgbG9jYXRpb24uaG91cl9wcmljZSArIFwiL2hvdXJcIiA6IFwiXCI7XG4gICAgICAgIGxldCBpbWFnZV91cmwgPSBsb2NhdGlvbi5pbWFnZV91cmxzMlswXTsgLy8gVXNlIHNtYWxsZXIgdGh1bWJzXG5cbiAgICAgICAgJCgnLnJlc3VsdHMtbGlzdCcpLmFwcGVuZChgPGxpIFxuICAgICAgICAgICAgaWQ9XCJsb2NhdGlvbi0ke2luZGV4fVwiIFxuICAgICAgICAgICAgY2xhc3M9XCJyZXN1bHQtaXRlbVwiIFxuICAgICAgICAgICAgc3R5bGU9XCJiYWNrZ3JvdW5kLWltYWdlOnVybCgnJHtpbWFnZV91cmx9Jyk7IGRpc3BsYXk6IG5vbmU7XCI+XG4gICAgICAgICAgICAgICAgPGEgaHJlZj1cIiR7bG9jYXRpb25fdXJsIHx8IFwiI1wifVwiPlxuICAgICAgICAgICAgICAgICAgICA8dWwgY2xhc3M9XCJsb2NhdGlvbi1pbmZvXCI+XG4gICAgICAgICAgICAgICAgICAgICAgICA8bGkgY2xhc3M9XCJmaXJzdC1saW5lXCI+JHt3b3JrcGxhY2V9PC9saT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaT4ke2xvY2F0aW9uX25hbWV9PC9saT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaT5TY29yZTogJHtyZXZpZXdfc2NvcmV9PC9saT5cbiAgICAgICAgICAgICAgICAgICAgICAgIDxsaT4ke2RheV9wcmljZX08L2xpPlxuICAgICAgICAgICAgICAgICAgICAgICAgPGxpPiR7aG91cl9wcmljZX08L2xpPlxuICAgICAgICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgICAgIDwvYT5cbiAgICAgICAgICAgIDwvbGk+YCk7XG4gICAgICAgICQoJyNsb2NhdGlvbi0nK2luZGV4KS5mYWRlSW4oMTAwMCAqIGluZGV4KTsgLy8gQ3JlYXRlcyBjb29sIHByb2dyZXNzaXZlIGZhZGUgaW5cbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gcmV2ZWFsUmVzdWx0c0FyZWEoKSB7XG4gICAgLy8gU2Nyb2xsIGRvd24gdG8gZGlzcGxheSByZXN1bHRzXG4gICAgJCgnaHRtbCwgYm9keScpLmFuaW1hdGUoe1xuICAgICAgICBzY3JvbGxUb3A6ICQoXCIucmVzdWx0cy1zZWN0aW9uXCIpLmhlaWdodCgpXG4gICAgIH0sIDEwMDApO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVSZXN1bHRzQXJlYSgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICB1cGRhdGU6IHVwZGF0ZVJlc3VsdHMsXG4gICAgICAgIHJldmVhbFJlc3VsdHNBcmVhOiByZXZlYWxSZXN1bHRzQXJlYVxuICAgIH1cbn0iLCJmdW5jdGlvbiBjcmVhdGVSZXN1bHRzTGlzdChzdHIpIHtcbiAgICAvLyBDcmVhdGUgYSBuZXcgYXJyYXkgb2YgbG9jYXRpb25zIHRoYXQgbWF0Y2ggc2VhcmNoIHF1ZXJ5XG4gICAgLy8gVGhpcyBpcyBhIGhlbHBlciBmdW5jdGlvbiB0byBzaW11bGF0ZSBuZXcgc2VhcmNoIHJlc3VsdHNcbiAgICAvLyBJZiBhIGZ1bGwgQVBJIHdhcyB1c2VkLCB3ZSB3b3VsZG4ndCBuZWVkIHRoaXMgZnVuY3Rpb25cbiAgICAvLyBhcyB3ZSB3b3VsZCBoYXZlIFwiZmlsdGVyZWRcIiByZXN1bHRzIGFscmVhZHkgZnJvbSBBUEkgcGF5bG9hZFxuICAgIGxldCBsb2NhdGlvbnMgPSBhcHAubW9kZWwucmF3X2RhdGEucm93cztcbiAgICBpZiAoIXN0cikgcmV0dXJuIGxvY2F0aW9uczsgLy8gSWYgbm8gc2VhcmNoIGNyaXRlcmlhLCByZXR1cm4gd2hvbGUgbGlzdFxuICAgIGxldCByZXN1bHRzID0gbG9jYXRpb25zLmZpbHRlcihmdW5jdGlvbihsb2NhdGlvbikge1xuICAgICAgICBpZihsb2NhdGlvbi5uYW1lID09PSBzdHIgfHwgXG4gICAgICAgICAgIGxvY2F0aW9uLmxvY2F0aW9uX25hbWUgPT09IHN0ciB8fFxuICAgICAgICAgICBsb2NhdGlvbi5sb2NhdGlvbl9jaXR5ID09PSBzdHIpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfSk7XG5cbiAgICByZXR1cm4gcmVzdWx0cztcbn1cblxuZnVuY3Rpb24gY3JlYXRlU2VhcmNoTGlzdChsb2NhdGlvbnMpIHtcbiAgICAvLyBUYWtlcyBhbiBhcnJheSBvZiBsb2NhdGlvbnNcbiAgICAvLyAxLiBSZWR1Y2UgdG8gbmV3IGxpc3QganVzdCBvZiBsb2NhdGlvbiBuYW1lcyBvZiB2YXJpb3VzIHR5cGVcbiAgICAvLyAyLiBSZW1vdmUgYWxsIGR1cGxpY2F0ZXNcbiAgICAvLyAzLiBTb3J0XG4gICAgLy8gNC4gUmV0dXJuIGxpc3RcbiAgICBsZXQgcGxhY2VfaGFzaCA9IHt9O1xuICAgIGxldCBsb2NhdGlvbl9uYW1lcyA9IGxvY2F0aW9ucy5yZWR1Y2UoZnVuY3Rpb24oYWxsX25hbWVzLCBsb2NhdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIGFsbF9uYW1lcy5jb25jYXQoW2xvY2F0aW9uLm5hbWUsIGxvY2F0aW9uLmxvY2F0aW9uX25hbWUsIGxvY2F0aW9uLmxvY2F0aW9uX2NpdHldKTtcbiAgICAgICAgfSwgW10pXG4gICAgICAgIC5maWx0ZXIoZnVuY3Rpb24oaXRlbSkge1xuICAgICAgICAgICAgaWYgKCFwbGFjZV9oYXNoW2l0ZW1dKSB7XG4gICAgICAgICAgICAgICAgcGxhY2VfaGFzaFtpdGVtXSA9IHRydWU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICBsb2NhdGlvbl9uYW1lcy5zb3J0KChhLCBiKSA9PiBhLmxvY2FsZUNvbXBhcmUoYikpO1xuXG4gICAgcmV0dXJuIGxvY2F0aW9uX25hbWVzO1xufVxuXG5mdW5jdGlvbiBwcmVkaWN0U2VhcmNoKHN0cikge1xuICAgIC8vIEZpbHRlciBsaXN0IHRvIG9ubHkgaW5jbHVkZSBzdHJpbmdzIHRoYXQgaGF2ZSBnaXZlbiBzdHJpbmdcbiAgICAvLyBhcyBhIHN1YnN0cmluZ1xuICAgIGxldCBsaXN0ID0gYXBwLm1vZGVsLmxvY2F0aW9uX25hbWVzLmZpbHRlcihmdW5jdGlvbihwbGFjZSkge1xuICAgICAgICAvLyBUaGVyZSBpcyBwcm9iYWJseSBhIGJldHRlciB3YXkgdG8gZG8gdGhpcyB3aXRoIGEgdHJpZVxuICAgICAgICByZXR1cm4gcGxhY2UudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzdHIudG9Mb3dlckNhc2UoKSk7XG4gICAgfSk7XG5cbiAgICAvLyBVc2VyIG5ldyBsaXN0IHRvIGZpbGwgcHJlZGljdGlvbiBib3ggXG4gICAgLy8gd2l0aCBnaXZlbiBzZWxlY3RvclxuICAgIGZpbGxQcmVkaWN0b3JCb3goJy5wcmVkaWN0aXZlLXJlc3VsdHMnLCBsaXN0KTtcbn1cblxuZnVuY3Rpb24gZmlsbFByZWRpY3RvckJveChzZWxlY3RvciwgbGlzdCkge1xuICAgIC8vIFVzZSBsaXN0IHRvIGZpbGwgZWxlbWVudCB3aXRoIGxpc3QgaXRlbXNcblxuICAgIC8vIFNldCB2YXJpYWJsZSBmb3IgZWxlbWVudCB3aXRoIHNlbGVjdG9yXG4gICAgdmFyICRwcmVkaWN0b3IgPSAkKHNlbGVjdG9yKTtcblxuICAgIC8vIENsZWFyIGVsZW1lbnRcbiAgICAkcHJlZGljdG9yLmh0bWwoXCJcIik7XG5cbiAgICAvLyBBZGQgZmlyc3QgaXRlbSBmb3IgYWxsIHJlc3VsdHNcbiAgICAkcHJlZGljdG9yLmFwcGVuZChgXG4gICAgICAgICAgICA8bGkgZGF0YS1pZD1cIlwiIFxuICAgICAgICAgICAgICAgIGNsYXNzPVwicHJlZGljdGl2ZS1pdGVtXCJcbiAgICAgICAgICAgICAgICBkYXRhLW5hbWU9XCJBbGxcIj5TZWFyY2ggYWxsIGxvY2F0aW9ucy4uPC9saT5gKTtcblxuICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBsaXN0IGNyZWF0aW5nIGFuZCBhZGRpbmcgaXRlbXNcbiAgICBmb3IgKGxldCBsb2NhdGlvbiBvZiBsaXN0KSB7XG4gICAgICAgICRwcmVkaWN0b3IuYXBwZW5kKGBcbiAgICAgICAgICAgIDxsaSBkYXRhLWlkPVwiXCIgXG4gICAgICAgICAgICAgICAgY2xhc3M9XCJwcmVkaWN0aXZlLWl0ZW1cIlxuICAgICAgICAgICAgICAgIGRhdGEtbmFtZT1cIiR7bG9jYXRpb259XCI+JHtsb2NhdGlvbn08L2xpPmApO1xuICAgIH1cblxuICAgIC8vIFNldCBoYW5kbGVyIG9uIGFsbCBuZXdseSBjcmVhdGVkIGVsZW1lbnRzXG4gICAgLy8gSGFuZGxlciBjcmVhdGVzIGNsaWNrIGV2ZW50IHRvIG1vdmUgc2VsZWN0ZWQgaXRlbSdzIGRhdGEtbmFtZVxuICAgIC8vIHByb3BlcnR5IHZhbHVlIGludG8gc2VhcmNoIGJhciB0byBsZXQgdXNlciBtYW51YWxseSBjb250aW51ZSBzZWFyY2guXG4gICAgJCgnLnByZWRpY3RpdmUtaXRlbScpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICAgICBsZXQgbmFtZSA9ICQodGhpcykuZGF0YSgnbmFtZScpO1xuXG4gICAgICAgIC8vIElmIHVzZXIgc2VsZWN0cyBcIkFsbFwiLCBqdXN0IGdvIGFoZWFkIGFuZCBzZWFyY2ggYWxsXG4gICAgICAgIGlmIChuYW1lID09PSBcIkFsbFwiKSB7XG4gICAgICAgICAgICBwcm9jZXNzU2VhcmNoKCk7XG4gICAgICAgICAgICAvLyBTY3JvbGwgZG93biB0byByZXZlYWwgcmVzdWx0c1xuICAgICAgICAgICAgYXBwLmNvbXBvbmVudHMucmVzdWx0c19hcmVhLnJldmVhbFJlc3VsdHNBcmVhKCk7XG4gICAgICAgICAgICAvLyBOb3cgZG9uZS4gSGlkZSBib3hcbiAgICAgICAgICAgICQoJy5wcmVkaWN0aXZlLWJveCcpLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIC8vIFB1dCBkYXRhLW5hbWUgZnJvbSBpdGVtIGludG8gaW5wdXQgZmllbGRcbiAgICAgICAgICAgICQoJyNsb2NhdGlvbi1zZWFyY2gtZm9ybSBpbnB1dFt0eXBlPVwidGV4dFwiXScpLnZhbChuYW1lKTtcbiAgICAgICAgICAgIC8vIE5vdyBkb25lLiBIaWRlIGJveFxuICAgICAgICAgICAgJCgnLnByZWRpY3RpdmUtYm94JykuaGlkZSgpO1xuICAgICAgICB9XG4gICAgfSlcbn1cblxuZnVuY3Rpb24gcHJvY2Vzc1NlYXJjaChzdHIpIHtcbiAgICAvLyBGaXJzdCBjbGVhciByZXN1bHRzIGFuZCBzaG93IGxvYWRlclxuICAgICQoJy5yZXN1bHRzLWxpc3QnKS5odG1sKFwiXCIpO1xuICAgIC8vIFNob3cgbG9hZGVyIHdoaWxlIHdlIHdhaXQgZm9yIG5ldyByZXN1bHRzXG4gICAgJCgnLnJlc3VsdHMtc2VjdGlvbiAubG9hZGVyJykuc2hvdygpO1xuXG4gICAgLy8gQ2xlYXIgaW5wdXQgZmllbGRcbiAgICAkKCcjbG9jYXRpb24tc2VhcmNoLWZvcm0gaW5wdXRbdHlwZT1cInRleHRcIl0nKS52YWwoXCJcIik7XG4gICAgXG4gICAgLy8gSW5pdGlhdGUgZ2V0IGFuZCBzZXQgdXAgd2hlbiBmb3IgcHJvbWlzZVxuICAgICQud2hlbihnZXREYXRhKHN0cikpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAvLyBQcmV0ZW5kIHRvIGdldCBuZXcgc2VhcmNoIHJlc3VsdHMgd2l0aCBuZXcgcXVlcnlcbiAgICAgICAgLy8gYW5kIHVwZGF0ZSBtb2RlbFxuICAgICAgICBhcHAubW9kZWwucmF3X2RhdGEgPSBkYXRhO1xuXG4gICAgICAgIC8vIFRoaXMgbGluZSBpcyBvbmx5IHRvIHNpbXVsYXRlIG5ldyBzZWFyY2ggcmVzdWx0c1xuICAgICAgICBhcHAubW9kZWwubG9jYXRpb25zID0gY3JlYXRlUmVzdWx0c0xpc3Qoc3RyKTtcblxuICAgICAgICAvLyBVcGRhdGUgcmVzdWx0cyBhbmQgcmVzZXQgcmVzcG9uc2l2ZSBlbGVtZW50c1xuICAgICAgICBhcHAuY29tcG9uZW50cy5yZXN1bHRzX2FyZWEudXBkYXRlKGxvY2F0aW9ucyk7KGFwcC5tb2RlbC5sb2NhdGlvbnMpO1xuICAgICAgICBzZXREaW1lbnNpb25zRm9yUmVzcG9uc2l2ZUVsZW1lbnRzKCk7XG5cbiAgICAgICAgLy8gSGlkZSBsb2FkZXIgYWZ0ZXIgbG9hZGluZyBuZXcgcmVzdWx0c1xuICAgICAgICAkKCcucmVzdWx0cy1zZWN0aW9uIC5sb2FkZXInKS5mYWRlT3V0KCk7XG5cbiAgICB9KS5mYWlsKGZ1bmN0aW9uKGVycm9yKSB7XG5cbiAgICAgICAgLy8gU2V0IHVwIGZhaWwgZm9yIG9mZmxpbmUgZGV2IHdvcmtmbG93OlxuICAgICAgICAvLyBNb3N0bHkgdGhlIHNhbWUgYXMgYWJvdmVcbiAgICAgICAgY29uc29sZS5lcnJvcihcIkNvdWxkIG5vdCBjb25uZWN0IHRvIEFQSS5cIixcIlVzaW5nIHNlc3Npb24gc3RvcmFnZS4uXCIsIGVycm9yKTtcbiAgICAgICAgYXBwLm1vZGVsLmxvY2F0aW9ucyA9IGNyZWF0ZVJlc3VsdHNMaXN0KHN0cik7XG4gICAgICAgIC8vIFVwZGF0ZSByZXN1bHRzIGFuZCByZXNldCByZXNwb25zaXZlIGVsZW1lbnRzXG4gICAgICAgIGFwcC5jb21wb25lbnRzLnJlc3VsdHNfYXJlYS51cGRhdGUoYXBwLm1vZGVsLmxvY2F0aW9ucyk7XG4gICAgICAgIHNldERpbWVuc2lvbnNGb3JSZXNwb25zaXZlRWxlbWVudHMoKTtcbiAgICAgICAgLy8gSGlkZSBsb2FkZXIgYWZ0ZXIgbG9hZGluZyBuZXcgcmVzdWx0c1xuICAgICAgICAkKCcucmVzdWx0cy1zZWN0aW9uIC5sb2FkZXInKS5mYWRlT3V0KCk7XG4gICAgfSk7XG5cbn0iLCJmdW5jdGlvbiBzZXRFdmVudEhhbmRsZXJzKCkge1xuICAgIC8vIFNlYXJjaCBmb3JtXG4gICAgJCgnI2xvY2F0aW9uLXNlYXJjaC1mb3JtJykuc3VibWl0KGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAvLyBHZXQgc2VhcmNoIHF1ZXJ5IGZyb20gaW5wdXRcbiAgICAgICAgbGV0IHNlYXJjaF9pbnF1aXJ5ID0gJCgnaW5wdXRbdHlwZT1cInRleHRcIl0nKS52YWwoKTtcbiAgICAgICAgaWYoc2VhcmNoX2lucXVpcnkpIHtcbiAgICAgICAgICAgIC8vIElmIHNlYXJjaCBxdWVyeSwgcHJvY2VzcyBuZXcgc2VhcmNoXG4gICAgICAgICAgICBwcm9jZXNzU2VhcmNoKHNlYXJjaF9pbnF1aXJ5KTtcbiAgICAgICAgICAgIC8vIENsZWFyIGlucHV0XG4gICAgICAgICAgICAkKCdpbnB1dFt0eXBlPVwidGV4dFwiXScpLnZhbChcIlwiKTtcbiAgICAgICAgICAgIC8vIFNjcm9sbCBkb3duIHRvIHJldmVhbCBzZWFyY2ggYXJlYVxuICAgICAgICAgICAgYXBwLmNvbXBvbmVudHMucmVzdWx0c19hcmVhLnJldmVhbFJlc3VsdHNBcmVhKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIFNlYXJjaCBmb3JtIHByZWRpY3RpdmUgc2VhcmNoXG4gICAgJCgnI2xvY2F0aW9uLXNlYXJjaC1mb3JtIGlucHV0W3R5cGU9XCJ0ZXh0XCJdJykuZm9jdXMoZnVuY3Rpb24oKSB7XG4gICAgICAgIC8vIFdoZW4gZm9jdXMgaXMgb24gc2VhcmNoIGlucHV0XG4gICAgICAgIC8vIEV2YWx1YXRlIHN0cmluZyBvbiBrZXl1cCAtIGtleWRvd24gZmlyZXMgYmVmb3JlIHRleHQgaXMgYXZhaWxhYmxlXG4gICAgICAgICQoJyNsb2NhdGlvbi1zZWFyY2gtZm9ybSBpbnB1dFt0eXBlPVwidGV4dFwiXScpLmtleXVwKGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIGxldCBzZWFyY2hfaW5xdWlyeSA9ICQoJyNsb2NhdGlvbi1zZWFyY2gtZm9ybSBpbnB1dFt0eXBlPVwidGV4dFwiXScpLnZhbCgpO1xuICAgICAgICAgICAgLy8gSW5pdGlhdGUgcHJlZGljdGl2ZSBzZWFyY2ggcHJvY2VzcyB3aXRoIGN1cnJlbnQgaW5wdXRcbiAgICAgICAgICAgIHByZWRpY3RTZWFyY2goc2VhcmNoX2lucXVpcnkpO1xuICAgICAgICAgICAgLy8gU2hvdyBwcmVkaWN0aW9uc1xuICAgICAgICAgICAgJCgnLnByZWRpY3RpdmUtYm94Jykuc2hvdygpO1xuICAgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PSAyNykge1xuICAgICAgICAgICAgICAgIC8vIFVzZXIgcHJlc3NlZCBlc2Mga2V5XG4gICAgICAgICAgICAgICAgLy8gSGlkZSBib3ggYW5kIGNsZWFyIGlucHV0IGZpZWxkXG4gICAgICAgICAgICAgICAgJCgnLnByZWRpY3RpdmUtYm94JykuaGlkZSgpO1xuICAgICAgICAgICAgICAgICQoJyNsb2NhdGlvbi1zZWFyY2gtZm9ybSBpbnB1dFt0eXBlPVwidGV4dFwiXScpLnZhbChcIlwiKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KTtcblxuICAgIC8vIEhpZGUgcHJlZGljdGlvbiBib3ggd2hlbiBmb2N1cyBpc24ndCBvbiBzZWFyY2hcbiAgICAvLyBBTkQgY3Vyc29yIGlzbid0IG92ZXIgdGhlIGJveFxuICAgICQoJyNsb2NhdGlvbi1zZWFyY2gtZm9ybSBpbnB1dFt0eXBlPVwidGV4dFwiXScpLmZvY3Vzb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoISQoJy5wcmVkaWN0aXZlLWJveCcpLmlzKFwiOmhvdmVyXCIpKSB7XG4gICAgICAgICAgICAkKCcucHJlZGljdGl2ZS1ib3gnKS5oaWRlKCk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIEZpbGwgc2VhcmNoIGJhciB3aXRoIHdoYXRldmVyIGEgdXNlciBzZWxlY3RzIGZyb20gbGlzdFxuICAgICQoJy5wcmVkaWN0aXZlLWl0ZW0nKS5vbignY2xpY2snLCBmdW5jdGlvbigpIHtcbiAgICAgICAgLy8gQ2xlYXIgZmlyc3RcbiAgICAgICAgJCgnLnByZWRpY3RpdmUtcmVzdWx0cycpLmh0bWwoXCJcIik7XG4gICAgICAgIC8vIEdldCBuYW1lIGZyb20gaXRlbSBjbGlja2VkXG4gICAgICAgICQodGhpcykuZGF0YSgnbmFtZScpO1xuICAgICAgICAvLyBIaWRlIGJveFxuICAgICAgICAkKCcucHJlZGljdGl2ZS1ib3gnKS5oaWRlKCk7XG4gICAgfSlcbn0iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
